!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(w){"use strict";Array.prototype.reduce||(Array.prototype.reduce=function(e){var t,n=Object(this),o=n.length>>>0,i=0;if(2===arguments.length)t=arguments[1];else{for(;i<o&&!(i in n);)i++;if(o<=i)throw new TypeError("Reduce of empty array with no initial value");t=n[i++]}for(;i<o;i++)i in n&&(t=e(t,n[i],i,n));return t}),"function"!=typeof Array.prototype.filter&&(Array.prototype.filter=function(e){for(var t,n=Object(this),o=n.length>>>0,i=[],r=2<=arguments.length?arguments[1]:void 0,a=0;a<o;a++)a in n&&(t=n[a],e.call(r,t,a,n)&&i.push(t));return i}),Array.prototype.map||(Array.prototype.map=function(e,t){var n,o,i;if(null===this)throw new TypeError(" this is null or not defined");var r,a=Object(this),s=a.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(1<arguments.length&&(n=t),o=new Array(s),i=0;i<s;)i in a&&(r=a[i],r=e.call(n,r,i,a),o[i]=r),i++;return o});var e,t="function"==typeof define&&define.amd,n=navigator.userAgent,o=/MSIE|Trident/i.test(n);o&&((e=/MSIE (\d+[.]\d+)/.exec(n))&&(ve=parseFloat(e[1])),(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(n))&&(ve=parseFloat(e[1])));var i,N={isMac:-1<navigator.appVersion.indexOf("Mac"),isMSIE:o,isFF:/firefox/i.test(n),isWebkit:/webkit/i.test(n),isSafari:/safari/i.test(n),browserVersion:ve,jqueryVersion:parseFloat(w.fn.jquery),isSupportAmd:t,hasCodeMirror:t?require.specified("CodeMirror"):!!window.CodeMirror,isFontInstalled:function(e){var t="Comic Sans MS"===e?"Courier New":"Comic Sans MS",n=w("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),o=n.css("fontFamily",t).width(),t=n.css("fontFamily",e+","+t).width();return n.remove(),o!==t},isW3CRangeSupport:!!document.createRange},h=(i=0,{eq:function(t){return function(e){return t===e}},eq2:function(e,t){return e===t},peq2:function(n){return function(e,t){return e[n]===t[n]}},ok:function(){return!0},fail:function(){return!1},self:function(e){return e},not:function(e){return function(){return!e.apply(e,arguments)}},and:function(t,n){return function(e){return t(e)&&n(e)}},uniqueId:function(e){var t=++i+"";return e?e+t:t},rect2bnd:function(e){var t=w(document);return{top:e.top+t.scrollTop(),left:e.left+t.scrollLeft(),width:e.right-e.left,height:e.bottom-e.top}},invertObject:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[e[t]]=t);return n},namespaceToCamel:function(e,t){return(t=t||"")+e.split(".").map(function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}).join("")}}),T={head:r,last:a,initial:function(e){return e.slice(0,e.length-1)},tail:s,prev:function(e,t){t=l(e,t);return-1===t?null:e[t-1]},next:function(e,t){t=l(e,t);return-1===t?null:e[t+1]},find:function(e,t){for(var n=0,o=e.length;n<o;n++){var i=e[n];if(t(i))return i}},contains:d,all:function(e,t){for(var n=0,o=e.length;n<o;n++)if(!t(e[n]))return!1;return!0},sum:function(e,n){return n=n||h.self,e.reduce(function(e,t){return e+n(t)},0)},from:function(e){for(var t=[],n=-1,o=e.length;++n<o;)t[n]=e[n];return t},clusterBy:function(e,o){return e.length?s(e).reduce(function(e,t){var n=a(e);return o(a(n),t)?n[n.length]=t:e[e.length]=[t],e},[[e[0]]]):[]},compact:function(e){for(var t=[],n=0,o=e.length;n<o;n++)e[n]&&t.push(e[n]);return t},unique:function(e){for(var t=[],n=0,o=e.length;n<o;n++)d(t,e[n])||t.push(e[n]);return t}};function r(e){return e[0]}function a(e){return e[e.length-1]}function s(e){return e.slice(1)}function l(e,t){return w.inArray(t,e)}function d(e,t){return-1!==l(e,t)}var c,u,f,p,m,g,v,b,y,C,k=String.fromCharCode(160),S=(c=L("LI"),u=L("TABLE"),f=function(e){return e&&/^UL|^OL/.test(e.nodeName.toUpperCase())},p=L("HR"),m=L("BLOCKQUOTE"),g=function(e){return R(e)||m(e)||x(e)},ve=L("A"),t=L("BODY"),v=N.isMSIE&&N.browserVersion<11?"&nbsp;":"<br>",b=function(e,t){for(;e;){if(t(e))return e;if(x(e))break;e=e.parentNode}return null},y=function(e){for(var t=0;e=e.previousSibling;)t+=1;return t},C=L("TEXTAREA"),{NBSP_CHAR:k,ZERO_WIDTH_NBSP_CHAR:"\ufeff",blank:v,emptyPara:"<p>"+v+"</p>",makePredByNodeName:L,isEditable:x,isControlSizing:function(e){return e&&w(e).hasClass("note-control-sizing")},buildLayoutInfo:P,makeLayoutInfo:function(e){e=w(e).closest(".note-editor, .note-air-editor, .note-air-layout");return e.length?(e=e.is(".note-editor, .note-air-editor")?e:w("#note-editor-"+T.last(e.attr("id").split("-"))),P(e)):null},isText:E,isVoid:F,isPara:I,isPurePara:function(e){return I(e)&&!c(e)},isInline:M,isBlock:h.not(M),isBodyInline:function(e){return M(e)&&!b(e,I)},isBody:t,isParaInline:function(e){return M(e)&&!!b(e,I)},isList:f,isTable:u,isCell:R,isBlockquote:m,isBodyContainer:g,isAnchor:ve,isDiv:L("DIV"),isLi:c,isBR:L("BR"),isSpan:L("SPAN"),isB:L("B"),isU:L("U"),isS:L("S"),isI:L("I"),isImg:L("IMG"),isTextarea:C,isEmpty:D,isEmptyAnchor:h.and(ve,D),isClosestSibling:function(e,t){return e.nextSibling===t||e.previousSibling===t},withClosestSiblings:function(e,t){t=t||h.ok;var n=[];return e.previousSibling&&t(e.previousSibling)&&n.push(e.previousSibling),n.push(e),e.nextSibling&&t(e.nextSibling)&&n.push(e.nextSibling),n},nodeLength:A,isLeftEdgePoint:j,isRightEdgePoint:K,isEdgePoint:V,isLeftEdgeOf:q,isRightEdgeOf:W,isLeftEdgePointOf:function(e,t){return j(e)&&q(e.node,t)},isRightEdgePointOf:function(e,t){return K(e)&&W(e.node,t)},prevPoint:Z,nextPoint:G,isSamePoint:J,isVisiblePoint:function(e){if(E(e.node)||!_(e.node)||D(e.node))return!0;var t=e.node.childNodes[e.offset-1],e=e.node.childNodes[e.offset];return!(t&&!F(t)||e&&!F(e))},prevPointUntil:function(e,t){for(;e;){if(t(e))return e;e=Z(e)}return null},nextPointUntil:function(e,t){for(;e;){if(t(e))return e;e=G(e)}return null},isCharPoint:function(e){if(!E(e.node))return!1;e=e.node.nodeValue.charAt(e.offset-1);return e&&" "!==e&&e!==k},walkPoint:function(e,t,n,o){for(var i=e;i&&(n(i),!J(i,t));)var r=o&&e.node!==i.node&&t.node!==i.node,i=G(i,r)},ancestor:b,singleChildAncestor:function(e,t){for(e=e.parentNode;e&&1===A(e);){if(t(e))return e;if(x(e))break;e=e.parentNode}return null},listAncestor:B,lastAncestor:function(e,t){e=B(e);return T.last(e.filter(t))},listNext:z,listPrev:function(e,t){t=t||h.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.previousSibling;return n},listDescendant:function(i,r){var a=[];return r=r||h.ok,function e(t){i!==t&&r(t)&&a.push(t);for(var n=0,o=t.childNodes.length;n<o;n++)e(t.childNodes[n])}(i),a},commonAncestor:function(e,t){for(var n=B(e),o=t;o;o=o.parentNode)if(-1<w.inArray(o,n))return o;return null},wrap:function(e,t){var n=e.parentNode,t=w("<"+t+">")[0];return n.insertBefore(t,e),t.appendChild(e),t},insertAfter:U,appendChildNodes:O,position:y,hasChildren:_,makeOffsetPath:function(e,t){return B(t,h.eq(e)).map(y).reverse()},fromOffsetPath:function(e,t){for(var n=e,o=0,i=t.length;o<i;o++)n=n.childNodes.length<=t[o]?n.childNodes[n.childNodes.length-1]:n.childNodes[t[o]];return n},splitTree:Q,splitPoint:function(e,t){var n,o=t?I:g,i=B(e.node,o),r=T.last(i)||e.node,r=o(r)?(n=i[i.length-2],r):(n=r).parentNode,t=n&&Q(n,e,{isSkipPaddingBlankHTML:t,isNotSplitEdgePoint:t});return t||r!==e.node||(t=e.node.childNodes[e.offset]),{rightNode:t,container:r}},create:X,createText:function(e){return document.createTextNode(e)},remove:$,removeWhile:function(e,t){for(;e&&!x(e)&&t(e);){var n=e.parentNode;$(e),e=n}},replace:function(e,t){if(e.nodeName.toUpperCase()===t.toUpperCase())return e;t=X(t);return e.style.cssText&&(t.style.cssText=e.style.cssText),O(t,T.from(e.childNodes)),U(t,e),$(e),t},html:function(e,t){e=ee(e);return t&&(e=e.replace(/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g,function(e,t,n){n=n.toUpperCase();t=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(n)&&!!t,n=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(n);return e+(t||n?"\n":"")}),e=w.trim(e)),e},value:ee});function x(e){return e&&w(e).hasClass("note-editable")}function P(n){if(n.hasClass("note-air-editor")){var e,t=T.last(n.attr("id").split("-"));return{editor:function(){return n},holder:function(){return n.data("holder")},editable:function(){return n},popover:(e=function(e){return function(){return w(e+t)}})("#note-popover-"),handle:e("#note-handle-"),dialog:e("#note-dialog-")}}e=function(e,t){return t=t||n,function(){return t.find(e)}};var o=(o=n.data("options"))&&o.dialogsInBody?w(document.body):null;return{editor:function(){return n},holder:function(){return n.data("holder")},dropzone:e(".note-dropzone"),toolbar:e(".note-toolbar"),editable:e(".note-editable"),codable:e(".note-codable"),statusbar:e(".note-statusbar"),popover:e(".note-popover"),handle:e(".note-handle"),dialog:e(".note-dialog",o)}}function L(t){return t=t.toUpperCase(),function(e){return e&&e.nodeName.toUpperCase()===t}}function E(e){return e&&3===e.nodeType}function F(e){return e&&/^BR|^IMG|^HR|^IFRAME|^BUTTON/.test(e.nodeName.toUpperCase())}function I(e){return!x(e)&&(e&&/^DIV|^P|^LI|^H[1-7]/.test(e.nodeName.toUpperCase()))}function M(e){return!(g(e)||f(e)||p(e)||I(e)||u(e)||m(e))}function R(e){return e&&/^TD|^TH/.test(e.nodeName.toUpperCase())}function A(e){return(E(e)?e.nodeValue:e.childNodes).length}function D(e){var t=A(e);return 0===t||(!E(e)&&1===t&&e.innerHTML===v||!(!T.all(e.childNodes,E)||""!==e.innerHTML))}function H(e){F(e)||A(e)||(e.innerHTML=v)}function B(e,t){t=t||h.fail;var n=[];return b(e,function(e){return x(e)||n.push(e),t(e)}),n}function z(e,t){t=t||h.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.nextSibling;return n}function U(e,t){var n=t.nextSibling,t=t.parentNode;return n?t.insertBefore(e,n):t.appendChild(e),e}function O(n,e){return w.each(e,function(e,t){n.appendChild(t)}),n}function j(e){return 0===e.offset}function K(e){return e.offset===A(e.node)}function V(e){return j(e)||K(e)}function q(e,t){for(;e&&e!==t;){if(0!==y(e))return!1;e=e.parentNode}return!0}function W(e,t){for(;e&&e!==t;){if(y(e)!==A(e.parentNode)-1)return!1;e=e.parentNode}return!0}function _(e){return!!(e&&e.childNodes&&e.childNodes.length)}function Z(e,t){var n,o;if(0===e.offset){if(x(e.node))return null;n=e.node.parentNode,o=y(e.node)}else o=_(e.node)?(n=e.node.childNodes[e.offset-1],A(n)):(n=e.node,t?0:e.offset-1);return{node:n,offset:o}}function G(e,t){var n,o;if(A(e.node)===e.offset){if(x(e.node))return null;n=e.node.parentNode,o=y(e.node)+1}else o=_(e.node)?(n=e.node.childNodes[e.offset],0):(n=e.node,t?A(e.node):e.offset+1);return{node:n,offset:o}}function J(e,t){return e.node===t.node&&e.offset===t.offset}function Y(e,t){var n=t&&t.isSkipPaddingBlankHTML,o=t&&t.isNotSplitEdgePoint;if(V(e)&&(E(e.node)||o)){if(j(e))return e.node;if(K(e))return e.node.nextSibling}return E(e.node)?e.node.splitText(e.offset):(t=e.node.childNodes[e.offset],o=U(e.node.cloneNode(!1),e.node),O(o,z(t)),n||(H(e.node),H(o)),o)}function Q(e,n,o){return(e=B(n.node,h.eq(e))).length?1===e.length?Y(n,o):e.reduce(function(e,t){return e===n.node&&(e=Y(n,o)),Y({node:t,offset:e?S.position(e):A(t)},o)}):null}function X(e){return document.createElement(e)}function $(e,t){if(e&&e.parentNode){if(e.removeNode)return e.removeNode(t);var n=e.parentNode;if(!t){for(var o=[],i=0,r=e.childNodes.length;i<r;i++)o.push(e.childNodes[i]);for(i=0,r=o.length;i<r;i++)n.insertBefore(o[i],e)}n.removeChild(e)}}function ee(e,t){return e=C(e[0])?e.val():e.html(),t?e.replace(/[\n\r]/g,""):e}var te,ne=(te=function(o,i,r,a){this.sc=o,this.so=i,this.ec=r,this.eo=a;function n(){if(N.isW3CRangeSupport){var e=document.createRange();return e.setStart(o,i),e.setEnd(r,a),e}return(e=ie({node:o,offset:i})).setEndPoint("EndToEnd",ie({node:r,offset:a})),e}this.getPoints=function(){return{sc:o,so:i,ec:r,eo:a}},this.getStartPoint=function(){return{node:o,offset:i}},this.getEndPoint=function(){return{node:r,offset:a}},this.select=function(){var e,t=n();return N.isW3CRangeSupport?(0<(e=document.getSelection()).rangeCount&&e.removeAllRanges(),e.addRange(t)):t.select(),this},this.normalize=function(){var e=function(e,t){if(S.isVisiblePoint(e)&&!S.isEdgePoint(e)||S.isVisiblePoint(e)&&S.isRightEdgePoint(e)&&!t||S.isVisiblePoint(e)&&S.isLeftEdgePoint(e)&&t||S.isVisiblePoint(e)&&S.isBlock(e.node)&&S.isEmpty(e.node))return e;var n=S.ancestor(e.node,S.isBlock);if((S.isLeftEdgePointOf(e,n)||S.isVoid(S.prevPoint(e).node))&&!t||(S.isRightEdgePointOf(e,n)||S.isVoid(S.nextPoint(e).node))&&t){if(S.isVisiblePoint(e))return e;t=!t}return(t?S.nextPointUntil(S.nextPoint(e),S.isVisiblePoint):S.prevPointUntil(S.prevPoint(e),S.isVisiblePoint))||e},t=e(this.getEndPoint(),!1),e=this.isCollapsed()?t:e(this.getStartPoint(),!0);return new te(e.node,e.offset,t.node,t.offset)},this.nodes=function(n,e){n=n||h.ok;var o=e&&e.includeAncestor,i=e&&e.fullyContains,t=this.getStartPoint(),e=this.getEndPoint(),r=[],a=[];return S.walkPoint(t,e,function(e){var t;S.isEditable(e.node)||(i?(S.isLeftEdgePoint(e)&&a.push(e.node),S.isRightEdgePoint(e)&&T.contains(a,e.node)&&(t=e.node)):t=o?S.ancestor(e.node,n):e.node,t&&n(t)&&r.push(t))},!0),T.unique(r)},this.commonAncestor=function(){return S.commonAncestor(o,r)},this.expand=function(e){var t=S.ancestor(o,e),n=S.ancestor(r,e);if(!t&&!n)return new te(o,i,r,a);e=this.getPoints();return t&&(e.sc=t,e.so=0),n&&(e.ec=n,e.eo=S.nodeLength(n)),new te(e.sc,e.so,e.ec,e.eo)},this.collapse=function(e){return e?new te(o,i,o,i):new te(r,a,r,a)},this.splitText=function(){var e=o===r,t=this.getPoints();return S.isText(r)&&!S.isEdgePoint(this.getEndPoint())&&r.splitText(a),S.isText(o)&&!S.isEdgePoint(this.getStartPoint())&&(t.sc=o.splitText(i),t.so=0,e&&(t.ec=t.sc,t.eo=a-i)),new te(t.sc,t.so,t.ec,t.eo)},this.deleteContents=function(){if(this.isCollapsed())return this;var e=this.splitText(),t=e.nodes(null,{fullyContains:!0}),o=S.prevPointUntil(e.getStartPoint(),function(e){return!T.contains(t,e.node)}),i=[];return w.each(t,function(e,t){var n=t.parentNode;o.node!==n&&1===S.nodeLength(n)&&i.push(n),S.remove(t,!1)}),w.each(i,function(e,t){S.remove(t,!1)}),new te(o.node,o.offset,o.node,o.offset).normalize()};function e(t){return function(){var e=S.ancestor(o,t);return!!e&&e===S.ancestor(r,t)}}this.isOnEditable=e(S.isEditable),this.isOnList=e(S.isList),this.isOnAnchor=e(S.isAnchor),this.isOnCell=e(S.isCell),this.isLeftEdgeOf=function(e){if(!S.isLeftEdgePoint(this.getStartPoint()))return!1;e=S.ancestor(this.sc,e);return e&&S.isLeftEdgeOf(this.sc,e)},this.isCollapsed=function(){return o===r&&i===a},this.wrapBodyInlineWithPara=function(){if(S.isBodyContainer(o)&&S.isEmpty(o))return o.innerHTML=S.emptyPara,new te(o.firstChild,0,o.firstChild,0);var e,t=this.normalize();if(S.isParaInline(o)||S.isPara(o))return t;S.isInline(t.sc)?(e=S.listAncestor(t.sc,h.not(S.isInline)),n=T.last(e),S.isInline(n)||(n=e[e.length-2]||t.sc.childNodes[t.so])):n=t.sc.childNodes[0<t.so?t.so-1:0];var n,t=S.listPrev(n,S.isParaInline).reverse();return(t=t.concat(S.listNext(n.nextSibling,S.isParaInline))).length&&(n=S.wrap(T.head(t),"p"),S.appendChildNodes(n,T.tail(t))),this.normalize()},this.insertNode=function(e){var t=this.wrapBodyInlineWithPara().deleteContents(),t=S.splitPoint(t.getStartPoint(),S.isInline(e));return t.rightNode?t.rightNode.parentNode.insertBefore(e,t.rightNode):t.container.appendChild(e),e},this.pasteHTML=function(e){var e=w("<div></div>").html(e)[0],e=T.from(e.childNodes),t=this.wrapBodyInlineWithPara().deleteContents();return e.reverse().map(function(e){return t.insertNode(e)}).reverse()},this.toString=function(){var e=n();return N.isW3CRangeSupport?e.toString():e.text},this.getWordRange=function(e){var t=this.getEndPoint();if(!S.isCharPoint(t))return this;var n=S.prevPointUntil(t,function(e){return!S.isCharPoint(e)});return e&&(t=S.nextPointUntil(t,function(e){return!S.isCharPoint(e)})),new te(n.node,n.offset,t.node,t.offset)},this.bookmark=function(e){return{s:{path:S.makeOffsetPath(e,o),offset:i},e:{path:S.makeOffsetPath(e,r),offset:a}}},this.paraBookmark=function(e){return{s:{path:T.tail(S.makeOffsetPath(T.head(e),o)),offset:i},e:{path:T.tail(S.makeOffsetPath(T.last(e),r)),offset:a}}},this.getClientRects=function(){return n().getClientRects()}},{create:function(e,t,n,o){if(arguments.length)2===arguments.length&&(n=e,o=t);else if(N.isW3CRangeSupport){var i=document.getSelection();if(!i||0===i.rangeCount)return null;if(S.isBody(i.anchorNode))return null;var r=i.getRangeAt(0);e=r.startContainer,t=r.startOffset,n=r.endContainer,o=r.endOffset}else{i=document.selection.createRange(),r=i.duplicate();r.collapse(!1);i=i;i.collapse(!0);i=oe(i,!0),r=oe(r,!1);S.isText(i.node)&&S.isLeftEdgePoint(i)&&S.isTextNode(r.node)&&S.isRightEdgePoint(r)&&r.node.nextSibling===i.node&&(i=r),e=i.cont,t=i.offset,n=r.cont,o=r.offset}return new te(e,t,n,o)},createFromNode:function(e){var t=e,n=0,o=e,e=S.nodeLength(o);return S.isVoid(t)&&(n=S.listPrev(t).length-1,t=t.parentNode),S.isBR(o)?(e=S.listPrev(o).length-1,o=o.parentNode):S.isVoid(o)&&(e=S.listPrev(o).length,o=o.parentNode),this.create(t,n,o,e)},createFromNodeBefore:function(e){return this.createFromNode(e).collapse(!0)},createFromNodeAfter:function(e){return this.createFromNode(e).collapse()},createFromBookmark:function(e,t){var n=S.fromOffsetPath(e,t.s.path),o=t.s.offset,e=S.fromOffsetPath(e,t.e.path),t=t.e.offset;return new te(n,o,e,t)},createFromParaBookmark:function(e,t){var n=e.s.offset,o=e.e.offset,i=S.fromOffsetPath(T.head(t),e.s.path),e=S.fromOffsetPath(T.last(t),e.e.path);return new te(i,n,e,o)}});function oe(e,t){for(var n,o=e.parentElement(),i=document.body.createTextRange(),r=T.from(o.childNodes),a=0;a<r.length;a++)if(!S.isText(r[a])){if(i.moveToElementText(r[a]),0<=i.compareEndPoints("StartToStart",e))break;n=r[a]}if(0!==a&&S.isText(r[a-1])){var s=document.body.createTextRange(),l=null;s.moveToElementText(n||o),s.collapse(!n),l=n?n.nextSibling:o.firstChild;var d=e.duplicate();d.setEndPoint("StartToStart",s);for(var c=d.text.replace(/[\r\n]/g,"").length;c>l.nodeValue.length&&l.nextSibling;)c-=l.nodeValue.length,l=l.nextSibling;l.nodeValue;t&&l.nextSibling&&S.isText(l.nextSibling)&&c===l.nodeValue.length&&(c-=l.nodeValue.length,l=l.nextSibling),o=l,a=c}return{cont:o,offset:a}}function ie(e){var r=function(e,t){if(S.isText(e)){var n=S.listPrev(e,h.not(S.isText)),o=T.last(n).previousSibling,i=o||e.parentNode;t+=T.sum(T.tail(n),S.nodeLength),o=!o}else{if(i=e.childNodes[t]||e,S.isText(i))return r(i,0);t=0,o=!1}return{node:i,collapseToStart:o,offset:t}},t=document.body.createTextRange(),e=r(e.node,e.offset);return t.moveToElementText(e.node),t.collapse(e.collapseToStart),t.moveStart("character",e.offset),t}function re(t){function e(e){null!==e.contents&&t.html(e.contents),null!==e.bookmark&&ne.createFromBookmark(i,e.bookmark).select()}var n=[],o=-1,i=t[0];this.undo=function(){t.html()!==n[o].contents&&this.recordUndo(),0<o&&e(n[--o])},this.redo=function(){n.length-1>o&&e(n[++o])},this.recordUndo=function(){var e;o++,n.length>o&&(n=n.slice(0,o)),n.push((e=ne.create(),{contents:t.html(),bookmark:e?e.bookmark(i):{s:{path:[],offset:0},e:{path:[],offset:0}}}))},this.recordUndo()}function ae(){this.fromNode=function(e){e=function(n,e){if(N.jqueryVersion<1.9){var o={};return w.each(e,function(e,t){o[t]=n.css(t)}),o}return n.css.call(n,e)}(e,["font-family","font-size","text-align","list-style-type","line-height"])||{};return e["font-size"]=parseInt(e["font-size"],10),e},this.stylePara=function(e,n){w.each(e.nodes(S.isPara,{includeAncestor:!0}),function(e,t){w(t).css(n)})},this.styleNodes=function(e,t){e=e.splitText();var n=t&&t.nodeName||"SPAN",o=!(!t||!t.expandClosestSibling),i=!(!t||!t.onlyPartialContains);if(e.isCollapsed())return[e.insertNode(S.create(n))];var r,a=S.makePredByNodeName(n),t=e.nodes(S.isText,{fullyContains:!0}).map(function(e){return S.singleChildAncestor(e,a)||S.wrap(e,n)});return o?(i&&(r=e.nodes(),a=h.and(a,function(e){return T.contains(r,e)})),t.map(function(e){var t=S.withClosestSiblings(e,a),n=T.head(t),e=T.tail(t);return w.each(e,function(e,t){S.appendChildNodes(n,t.childNodes),S.remove(t)}),T.head(t)})):t},this.current=function(e){var t=w(S.isText(e.sc)?e.sc.parentNode:e.sc),t=this.fromNode(t);t["font-bold"]=document.queryCommandState("bold")?"bold":"normal",t["font-italic"]=document.queryCommandState("italic")?"italic":"normal",t["font-underline"]=document.queryCommandState("underline")?"underline":"normal",t["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal",t["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal",t["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal",e.isOnList()?(n=-1<w.inArray(t["list-style-type"],["circle","disc","disc-leading-zero","square"]),t["list-style"]=n?"unordered":"ordered"):t["list-style"]="none";var n=S.ancestor(e.sc,S.isPara);return n&&n.style["line-height"]?t["line-height"]=n.style.lineHeight:(n=parseInt(t["line-height"],10)/parseInt(t["font-size"],10),t["line-height"]=n.toFixed(1)),t.anchor=e.isOnAnchor()&&S.ancestor(e.sc,S.isAnchor),t.ancestors=S.listAncestor(e.sc,S.isEditable),t.range=e,t}}function se(){this.insertOrderedList=function(){this.toggleList("OL")},this.insertUnorderedList=function(){this.toggleList("UL")},this.indent=function(){var o=this,e=ne.create().wrapBodyInlineWithPara(),t=e.nodes(S.isPara,{includeAncestor:!0}),t=T.clusterBy(t,h.peq2("parentNode"));w.each(t,function(e,t){var n=T.head(t);S.isLi(n)?o.wrapList(t,n.parentNode.nodeName):w.each(t,function(e,t){w(t).css("marginLeft",function(e,t){return(parseInt(t,10)||0)+25})})}),e.select()},this.outdent=function(){var o=this,e=ne.create().wrapBodyInlineWithPara(),t=e.nodes(S.isPara,{includeAncestor:!0}),t=T.clusterBy(t,h.peq2("parentNode"));w.each(t,function(e,t){var n=T.head(t);S.isLi(n)?o.releaseList([t]):w.each(t,function(e,t){w(t).css("marginLeft",function(e,t){return 25<(t=parseInt(t,10)||0)?t-25:""})})}),e.select()},this.toggleList=function(n){var o,i=this,e=ne.create().wrapBodyInlineWithPara(),t=e.nodes(S.isPara,{includeAncestor:!0}),r=e.paraBookmark(t),a=T.clusterBy(t,h.peq2("parentNode"));T.find(t,S.isPurePara)?(o=[],w.each(a,function(e,t){o=o.concat(i.wrapList(t,n))}),t=o):(e=e.nodes(S.isList,{includeAncestor:!0}).filter(function(e){return!w.nodeName(e,n)})).length?w.each(e,function(e,t){S.replace(t,n)}):t=this.releaseList(a,!0),ne.createFromParaBookmark(r,t).select()},this.wrapList=function(e,t){var n=T.head(e),o=T.last(e),i=S.isList(n.previousSibling)&&n.previousSibling,n=S.isList(o.nextSibling)&&o.nextSibling,o=i||S.insertAfter(S.create(t||"UL"),o);return e=e.map(function(e){return S.isPurePara(e)?S.replace(e,"LI"):e}),S.appendChildNodes(o,e),n&&(S.appendChildNodes(o,T.from(n.childNodes)),S.remove(n)),e},this.releaseList=function(e,r){var a=[];return w.each(e,function(e,t){var n=T.head(t),o=T.last(t),i=r?S.lastAncestor(n,S.isList):n.parentNode,o=1<i.childNodes.length?S.splitTree(i,{node:o.parentNode,offset:S.position(o)+1},{isSkipPaddingBlankHTML:!0}):null,n=S.splitTree(i,{node:n.parentNode,offset:S.position(n)},{isSkipPaddingBlankHTML:!0});t=r?S.listDescendant(n,S.isLi):T.from(n.childNodes).filter(S.isLi),!r&&S.isList(i.parentNode)||(t=t.map(function(e){return S.replace(e,"P")})),w.each(T.from(t).reverse(),function(e,t){S.insertAfter(t,i)});o=T.compact([i,n,o]);w.each(o,function(e,t){t=[t].concat(S.listDescendant(t,S.isList));w.each(t.reverse(),function(e,t){S.nodeLength(t)||S.remove(t,!0)})}),a=a.concat(t)}),a}}function le(){var i=new se;this.insertTab=function(e,t,n){var o=S.createText(new Array(n+1).join(S.NBSP_CHAR));(t=t.deleteContents()).insertNode(o,!0),(t=ne.create(o,n)).select()},this.insertParagraph=function(){var e=ne.create();e=(e=e.deleteContents()).wrapBodyInlineWithPara();var t=S.ancestor(e.sc,S.isPara);if(t){if(S.isEmpty(t)&&S.isLi(t))return void i.toggleList(t.parentNode.nodeName);o=S.splitTree(t,e.getStartPoint());var n=(n=S.listDescendant(t,S.isEmptyAnchor)).concat(S.listDescendant(o,S.isEmptyAnchor));w.each(n,function(e,t){S.remove(t)})}else{var n=e.sc.childNodes[e.so],o=w(S.emptyPara)[0];n?e.sc.insertBefore(o,n):e.sc.appendChild(o)}ne.create(o,0).normalize().select()}}function de(){this.tab=function(e,t){var n=S.ancestor(e.commonAncestor(),S.isCell),e=S.ancestor(n,S.isTable),e=S.listDescendant(e,S.isCell),n=T[t?"prev":"next"](e,n);n&&ne.create(n,0).select()},this.createTable=function(e,t){for(var n,o=[],i=0;i<e;i++)o.push("<td>"+S.blank+"</td>");n=o.join("");for(var r,a=[],s=0;s<t;s++)a.push("<tr>"+n+"</tr>");return r=a.join(""),w('<table class="table table-bordered">'+r+"</table>")[0]}}function ce(o){var t=this,s=new ae,i=new de,r=new le,n=new se;function a(e){var t=S.makeLayoutInfo(e).holder();o.bindCustomEvent(t,e.data("callbacks"),"before.command")(e.html(),e)}function l(e){var t=S.makeLayoutInfo(e).holder();o.bindCustomEvent(t,e.data("callbacks"),"change")(e.html(),e)}this.createRange=function(e){return this.focus(e),ne.create()},this.saveRange=function(e,t){this.focus(e),e.data("range",ne.create()),t&&ne.create().collapse().select()},this.saveNode=function(e){for(var t=[],n=0,o=e[0].childNodes.length;n<o;n++)t.push(e[0].childNodes[n]);e.data("childNodes",t)},this.restoreRange=function(e){var t=e.data("range");t&&(t.select(),this.focus(e))},this.restoreNode=function(e){e.html("");for(var t=e.data("childNodes"),n=0,o=t.length;n<o;n++)e[0].appendChild(t[n])},this.currentStyle=function(e){var t=ne.create(),t=t&&t.isOnEditable()?s.current(t.normalize()):{};return S.isImg(e)&&(t.image=e),t},this.styleFromNode=function(e){return s.fromNode(e)},this.undo=function(e){a(e),e.data("NoteHistory").undo(),l(e)},this.redo=function(e){a(e),e.data("NoteHistory").redo(),l(e)};for(var d=this.beforeCommand=function(e){a(e),t.focus(e)},c=this.afterCommand=function(e,t){e.data("NoteHistory").recordUndo(),t||l(e)},e=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","foreColor","fontName"],u=0,f=e.length;u<f;u++)this[e[u]]=function(n){return function(e,t){d(e),document.execCommand(n,!1,t),c(e,!0)}}(e[u]);for(this.tab=function(e,t){var n=this.createRange(e);n.isCollapsed()&&n.isOnCell()?i.tab(n):(d(e),r.insertTab(e,n,t.tabsize),c(e))},this.untab=function(e){e=this.createRange(e);e.isCollapsed()&&e.isOnCell()&&i.tab(e,!0)},this.insertParagraph=function(e){d(e),r.insertParagraph(e),c(e)},this.insertOrderedList=function(e){d(e),n.insertOrderedList(e),c(e)},this.insertUnorderedList=function(e){d(e),n.insertUnorderedList(e),c(e)},this.indent=function(e){d(e),n.indent(e),c(e)},this.outdent=function(e){d(e),n.outdent(e),c(e)},this.insertImage=function(t,e,n){ye.createImage(e,n).then(function(e){d(t),e.css({display:"",width:Math.min(t.width(),e.width())}),ne.create().insertNode(e[0]),ne.createFromNodeAfter(e[0]).select(),c(t)}).fail(function(){var e=S.makeLayoutInfo(t).holder();o.bindCustomEvent(e,t.data("callbacks"),"image.upload.error")()})},this.insertNode=function(e,t){d(e),ne.create().insertNode(t),ne.createFromNodeAfter(t).select(),c(e)},this.insertText=function(e,t){d(e);t=ne.create().insertNode(S.createText(t));ne.create(t,S.nodeLength(t)).select(),c(e)},this.pasteHTML=function(e,t){d(e);t=ne.create().pasteHTML(t);ne.createFromNodeAfter(T.last(t)).select(),c(e)},this.formatBlock=function(e,t){d(e),t=N.isMSIE?"<"+t+">":t,document.execCommand("FormatBlock",!1,t),c(e)},this.formatPara=function(e){d(e),this.formatBlock(e,"P"),c(e)},u=1;u<=6;u++)this["formatH"+u]=function(t){return function(e){this.formatBlock(e,"H"+t)}}(u);this.fontSize=function(e,t){var n,o,i=ne.create();i.isCollapsed()?(n=s.styleNodes(i),o=T.head(n),w(n).css({"font-size":t+"px"}),o&&!S.nodeLength(o)&&(o.innerHTML=S.ZERO_WIDTH_NBSP_CHAR,ne.createFromNodeAfter(o.firstChild).select(),e.data(ke,o))):(d(e),w(s.styleNodes(i)).css({"font-size":t+"px"}),c(e))},this.insertHorizontalRule=function(e){d(e);var t=ne.create().insertNode(w("<HR/>")[0]);t.nextSibling&&ne.create(t.nextSibling,0).normalize().select(),c(e)},this.removeBogus=function(e){var t,n,o=e.data(ke);o&&(-1!==(n=(t=T.find(T.from(o.childNodes),S.isText)).nodeValue.indexOf(S.ZERO_WIDTH_NBSP_CHAR))&&t.deleteData(n,1),S.isEmpty(o)&&S.remove(o),e.removeData(ke))},this.lineHeight=function(e,t){d(e),s.stylePara(ne.create(),{lineHeight:t}),c(e)},this.unlink=function(e){var t,n=this.createRange(e);n.isOnAnchor()&&(t=S.ancestor(n.sc,S.isAnchor),(n=ne.createFromNode(t)).select(),d(e),document.execCommand("unlink"),c(e))},this.createLink=function(e,t,n){var o=t.url,i=t.text,r=t.isNewWindow,a=t.range||this.createRange(e),t=a.toString()!==i;n=n||S.makeLayoutInfo(e).editor().data("options"),d(e),n.onCreateLink&&(o=n.onCreateLink(o));n=[];t?(i=a.insertNode(w("<A>"+i+"</A>")[0]),n.push(i)):n=s.styleNodes(a,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0}),w.each(n,function(e,t){w(t).attr("href",o),r?w(t).attr("target","_blank"):w(t).removeAttr("target")});a=ne.createFromNodeBefore(T.head(n)).getStartPoint(),n=ne.createFromNodeAfter(T.last(n)).getEndPoint();ne.create(a.node,a.offset,n.node,n.offset).select(),c(e)},this.getLinkInfo=function(e){this.focus(e);var t=ne.create().expand(S.isAnchor),e=w(T.head(t.nodes(S.isAnchor)));return{range:t,text:t.toString(),isNewWindow:!!e.length&&"_blank"===e.attr("target"),url:e.length?e.attr("href"):""}},this.color=function(e,t){var n=JSON.parse(t),t=n.foreColor,n=n.backColor;d(e),t&&document.execCommand("foreColor",!1,t),n&&document.execCommand("backColor",!1,n),c(e)},this.insertTable=function(e,t){t=t.split("x");d(e),ne.create().deleteContents().insertNode(i.createTable(t[0],t[1])),c(e)},this.floatMe=function(e,t,n){d(e),n.removeClass("pull-left pull-right"),t&&"none"!==t&&n.addClass("pull-"+t),n.css("float",t),c(e)},this.imageShape=function(e,t,n){d(e),n.removeClass("img-rounded img-circle img-thumbnail"),t&&n.addClass(t),c(e)},this.resize=function(e,t,n){d(e),n.css({width:100*t+"%",height:""}),c(e)},this.resizeTo=function(e,t,n){var o;e=n?{width:(o=e.y/e.x)<(n=t.data("ratio"))?e.x:e.y/n,height:o<n?e.x*n:e.y}:{width:e.x,height:e.y},t.css(e)},this.removeMedia=function(e,t,n){d(e),n.detach(),o.bindCustomEvent(w(),e.data("callbacks"),"media.delete")(n,e),c(e)},this.focus=function(e){e.focus(),N.isFF&&!ne.create().isOnEditable()&&ne.createFromNode(e[0]).normalize().collapse().select()},this.isEmpty=function(e){return S.isEmpty(e[0])||S.emptyPara===e.html()}}function ue(){this.update=function(n,e){function t(e,t){e.find(".dropdown-menu li a").each(function(){var e=w(this).data("value")+""==t+"";this.className=e?"checked":""})}function o(e,t){n.find(e).toggleClass("active",t())}if(e.image){var i=w(e.image);o('button[data-event="imageShape"][data-value="img-rounded"]',function(){return i.hasClass("img-rounded")}),o('button[data-event="imageShape"][data-value="img-circle"]',function(){return i.hasClass("img-circle")}),o('button[data-event="imageShape"][data-value="img-thumbnail"]',function(){return i.hasClass("img-thumbnail")}),o('button[data-event="imageShape"]:not([data-value])',function(){return!i.is(".img-rounded, .img-circle, .img-thumbnail")});var r=i.css("float");o('button[data-event="floatMe"][data-value="left"]',function(){return"left"===r}),o('button[data-event="floatMe"][data-value="right"]',function(){return"right"===r}),o('button[data-event="floatMe"][data-value="none"]',function(){return"left"!==r&&"right"!==r});var a=i.attr("style");return o('button[data-event="resize"][data-value="1"]',function(){return!!/(^|\s)(max-)?width\s*:\s*100%/.test(a)}),o('button[data-event="resize"][data-value="0.5"]',function(){return!!/(^|\s)(max-)?width\s*:\s*50%/.test(a)}),void o('button[data-event="resize"][data-value="0.25"]',function(){return!!/(^|\s)(max-)?width\s*:\s*25%/.test(a)})}var s=n.find(".note-fontname");if(s.length){var l=e["font-family"];if(l){for(var d=l.split(","),c=0,u=d.length;c<u&&(l=d[c].replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,""),!N.isFontInstalled(l));c++);s.find(".note-current-fontname").text(l),t(s,l)}}s=n.find(".note-fontsize");s.find(".note-current-fontsize").text(e["font-size"]),t(s,parseFloat(e["font-size"])),t(n.find(".note-height"),parseFloat(e["line-height"])),o('button[data-event="bold"]',function(){return"bold"===e["font-bold"]}),o('button[data-event="italic"]',function(){return"italic"===e["font-italic"]}),o('button[data-event="underline"]',function(){return"underline"===e["font-underline"]}),o('button[data-event="strikethrough"]',function(){return"strikethrough"===e["font-strikethrough"]}),o('button[data-event="superscript"]',function(){return"superscript"===e["font-superscript"]}),o('button[data-event="subscript"]',function(){return"subscript"===e["font-subscript"]}),o('button[data-event="justifyLeft"]',function(){return"left"===e["text-align"]||"start"===e["text-align"]}),o('button[data-event="justifyCenter"]',function(){return"center"===e["text-align"]}),o('button[data-event="justifyRight"]',function(){return"right"===e["text-align"]}),o('button[data-event="justifyFull"]',function(){return"justify"===e["text-align"]}),o('button[data-event="insertUnorderedList"]',function(){return"unordered"===e["list-style"]}),o('button[data-event="insertOrderedList"]',function(){return"ordered"===e["list-style"]})},this.updateRecentColor=function(e,t,n){var o=w(e).closest(".note-color").find(".note-recent-color"),e=JSON.parse(o.attr("data-value"));e[t]=n,o.attr("data-value",JSON.stringify(e));t="backColor"===t?"background-color":"color";o.find("i").css(t,n)}}function fe(){var o=new ue;this.update=function(e,t){o.update(e,t)},this.updateRecentColor=function(e,t,n){o.updateRecentColor(e,t,n)},this.activate=function(e){e.find("button").not('button[data-event="codeview"]').removeClass("disabled")},this.deactivate=function(e){e.find("button").not('button[data-event="codeview"]').addClass("disabled")},this.updateFullscreen=function(e,t){e.find('button[data-event="fullscreen"]').toggleClass("active",t)},this.updateCodeview=function(e,t){e.find('button[data-event="codeview"]').toggleClass("active",t),t?this.deactivate(e):this.activate(e)},this.get=function(e,t){return S.makeLayoutInfo(e).toolbar().find("[data-name="+t+"]")},this.setButtonState=function(e,t,n){n=!1!==n,this.get(e,t).toggleClass("active",n)}}function he(){var i=w(document);this.attach=function(e,t){t.disableResizeEditor||e.statusbar().on("mousedown",n)};var n=function(e){e.preventDefault(),e.stopPropagation();var t=S.makeLayoutInfo(e.target).editable(),n=t.offset().top-i.scrollTop(),o=S.makeLayoutInfo(e.currentTarget||e.target).editor().data("options");i.on("mousemove",function(e){e=e.clientY-(24+n),e=0<o.minHeight?Math.max(e,o.minHeight):e;e=0<o.maxHeight?Math.min(e,o.maxHeight):e,t.height(e)}).one("mouseup",function(){i.off("mousemove")})}}function pe(){function s(e,t){var n=t&&t.isAirMode,t=t&&t.isLeftTop,e=w(e),n=n?e.offset():e.position(),e=t?0:e.outerHeight(!0);return{left:n.left,top:n.top+e}}function l(e,t){e.css({display:"block",left:t.left,top:t.top})}var d=new ue;this.update=function(e,t,n){d.update(e,t);var o,i,r,a=e.find(".note-link-popover");t.anchor?(o=a.find("a"),i=w(t.anchor).attr("href"),r=w(t.anchor).attr("target"),o.attr("href",i).html(i),r?o.attr("target","_blank"):o.removeAttr("target"),l(a,s(t.anchor,{isAirMode:n}))):a.hide();a=e.find(".note-image-popover");t.image?l(a,s(t.image,{isAirMode:n,isLeftTop:!0})):a.hide();e=e.find(".note-air-popover");n&&t.range&&!t.range.isCollapsed()?(t=T.last(t.range.getClientRects()))&&(t=h.rect2bnd(t),l(e,{left:Math.max(t.left+t.width/2-20,0),top:t.top+t.height})):e.hide()},this.updateRecentColor=function(e,t,n){e.updateRecentColor(e,t,n)},this.hide=function(e){e.children().hide()}}function me(d){function t(e){var t,n,o,i,r,a,s,l;S.isControlSizing(e.target)&&(e.preventDefault(),e.stopPropagation(),e=S.makeLayoutInfo(e.target),t=e.handle(),n=e.popover(),o=e.editable(),e=e.editor(),i=t.find(".note-control-selection").data("target"),r=w(i),a=r.offset(),s=c.scrollTop(),l=e.data("options").airMode,c.on("mousemove",function(e){d.invoke("editor.resizeTo",{x:e.clientX-a.left,y:e.clientY-(a.top-s)},r,!e.shiftKey),d.invoke("handle.update",t,{image:i},l),d.invoke("popover.update",n,{image:i},l)}).one("mouseup",function(){c.off("mousemove"),d.invoke("editor.afterCommand",o)}),r.data("ratio")||r.data("ratio",r.height()/r.width()))}var c=w(document);this.attach=function(e){e.handle().on("mousedown",t)},this.update=function(e,t,n){var o=e.find(".note-control-selection");t.image?(e=w(t.image),n=n?e.offset():e.position(),e={w:e.outerWidth(!0),h:e.outerHeight(!0)},o.css({display:"block",left:n.left,top:n.top,width:e.w,height:e.h}).data("target",t.image),e=e.w+"x"+e.h,o.find(".note-control-selection-info").text(e)):o.hide()},this.hide=function(e){e.children().hide()}}function ge(a){var s=w(window),l=w("html, body");this.toggle=function(e){function t(e){i.css("height",e.h),r.css("height",e.h),r.data("cmeditor")&&r.data("cmeditor").setsize(null,e.h)}var n=e.editor(),o=e.toolbar(),i=e.editable(),r=e.codable();n.toggleClass("fullscreen");n=n.hasClass("fullscreen");n?(i.data("orgheight",i.css("height")),s.on("resize",function(){t({h:s.height()-o.outerHeight()})}).trigger("resize"),l.css("overflow","hidden")):(s.off("resize"),t({h:i.data("orgheight")}),l.css("overflow","visible")),a.invoke("toolbar.updateFullscreen",o,n)}}var ve,be,ye={readFileAsDataURL:function(e){return w.Deferred(function(t){w.extend(new FileReader,{onload:function(e){e=e.target.result;t.resolve(e)},onerror:function(){t.reject(this)}}).readAsDataURL(e)}).promise()},createImage:function(n,o){return w.Deferred(function(e){var t=w("<img>");t.one("load",function(){t.off("error abort"),e.resolve(t)}).one("error abort",function(){t.off("load").detach(),e.reject(t)}).css({display:"none"}).appendTo(document.body).attr({src:n,"data-filename":o})}).promise()}},Ce=(ve={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221},{isEdit:function(e){return T.contains([8,9,13,32],e)},isMove:function(e){return T.contains([37,38,39,40],e)},nameFromCode:h.invertObject(ve),code:ve}),ke="bogus";N.hasCodeMirror&&(N.isSupportAmd?require(["CodeMirror"],function(e){be=e}):be=window.CodeMirror);function xe(l){this.sync=function(e){l.invoke("codeview.isActivated",e)&&N.hasCodeMirror&&e.codable().data("cmEditor").save()},this.isActivated=function(e){return e.editor().hasClass("codeview")},this.toggle=function(e){this.isActivated(e)?this.deactivate(e):this.activate(e)},this.activate=function(e){var t,n=e.editor(),o=e.toolbar(),i=e.editable(),r=e.codable(),a=e.popover(),s=e.handle(),e=n.data("options");r.val(S.html(i,e.prettifyHtml)),r.height(i.height()),l.invoke("toolbar.updateCodeview",o,!0),l.invoke("popover.hide",a),l.invoke("handle.hide",s),n.addClass("codeview"),r.focus(),N.hasCodeMirror&&(n=be.fromTextArea(r[0],e.codemirror),e.codemirror.tern&&(t=new be.TernServer(e.codemirror.tern),n.ternServer=t,n.on("cursorActivity",function(e){t.updateArgHints(e)})),n.setSize(null,i.outerHeight()),r.data("cmEditor",n))},this.deactivate=function(e){var t=e.holder(),n=e.editor(),o=e.toolbar(),i=e.editable(),r=e.codable(),a=n.data("options");N.hasCodeMirror&&(s=r.data("cmEditor"),r.val(s.getValue()),s.toTextArea());var e=S.value(r,a.prettifyHtml)||S.emptyPara,s=i.html()!==e;i.html(e),i.height(a.height?r.height():"auto"),n.removeClass("codeview"),s&&l.bindCustomEvent(t,i.data("callbacks"),"change")(i.html(),i),i.focus(),l.invoke("toolbar.updateCodeview",o,!1)}}function we(d){var n=w(document);this.attach=function(e,t){t.airMode||t.disableDragAndDrop?n.on("drop",function(e){e.preventDefault()}):this.attachDragAndDropEvent(e,t)},this.attachDragAndDropEvent=function(o,i){var r=w(),a=o.editor(),s=o.dropzone(),l=s.find(".note-dropzone-message");n.on("dragenter",function(e){var t=d.invoke("codeview.isActivated",o),n=0<a.width()&&0<a.height();t||r.length||!n||(a.addClass("dragover"),s.width(a.width()),s.height(a.height()),l.text(i.langInfo.image.dragImageHere)),r=r.add(e.target)}).on("dragleave",function(e){(r=r.not(e.target)).length||a.removeClass("dragover")}).on("drop",function(){r=w(),a.removeClass("dragover")}),s.on("dragenter",function(){s.addClass("hover"),l.text(i.langInfo.image.dropImage)}).on("dragleave",function(){s.removeClass("hover"),l.text(i.langInfo.image.dragImageHere)}),s.on("drop",function(e){var t=e.originalEvent.dataTransfer,n=S.makeLayoutInfo(e.currentTarget||e.target);if(t&&t.files&&t.files.length)e.preventDefault(),n.editable().focus(),d.insertImages(n,t.files);else for(var o=function(){n.holder().summernote("insertNode",this)},i=0,r=t.types.length;i<r;i++){var a=t.types[i],s=t.getData(a);-1<a.toLowerCase().indexOf("text")?n.holder().summernote("pasteHTML",s):w(s).each(o)}}).on("dragover",!1)}}function Ne(s){var l;this.attach=function(t){N.isMSIE&&10<N.browserVersion||N.isFF?(l=w("<div />").attr("contenteditable",!0).css({position:"absolute",left:-1e5,opacity:0}),t.editable().on("keydown",function(e){e.ctrlKey&&e.keyCode===Ce.code.V&&(s.invoke("saveRange",t.editable()),l.focus(),setTimeout(function(){n(t)},0))}),t.editable().before(l)):t.editable().on("paste",e)};var n=function(e){var t=e.editable(),n=l[0].firstChild;if(S.isImg(n)){for(var o=n.src,i=atob(o.split(",")[1]),r=new Uint8Array(i.length),a=0;a<i.length;a++)r[a]=i.charCodeAt(a);o=new Blob([r],{type:"image/png"});o.name="clipboard.png",s.invoke("restoreRange",t),s.invoke("focus",t),s.insertImages(e,[o])}else{o=w("<div />").html(l.html()).html();s.invoke("restoreRange",t),s.invoke("focus",t),o&&s.invoke("pasteHTML",t,o)}l.empty()},e=function(e){var t=e.originalEvent.clipboardData,n=S.makeLayoutInfo(e.currentTarget||e.target),e=n.editable();t&&t.items&&t.items.length&&("file"===(t=T.head(t.items)).kind&&-1!==t.type.indexOf("image/")&&s.insertImages(n,[t.getAsFile()]),s.invoke("editor.afterCommand",e))}}function Te(a){function l(e,t){e.toggleClass("disabled",!t),e.attr("disabled",!t)}function d(e,t){e.on("keypress",function(e){e.keyCode===Ce.code.ENTER&&t.trigger("click")})}this.showLinkDialog=function(e,a,s){return w.Deferred(function(t){var n=a.find(".note-link-dialog"),o=n.find(".note-link-text"),i=n.find(".note-link-url"),e=n.find(".note-link-btn"),r=n.find("input[type=checkbox]");n.one("shown.bs.modal",function(){o.val(s.text),o.on("input",function(){l(e,o.val()&&i.val()),s.text=o.val()}),s.url||(s.url=s.text||"http://",l(e,s.text)),i.on("input",function(){l(e,o.val()&&i.val()),s.text||o.val(i.val())}).val(s.url).trigger("focus").trigger("select"),d(i,e),d(o,e),r.prop("checked",s.isNewWindow),e.one("click",function(e){e.preventDefault(),t.resolve({range:s.range,url:i.val(),text:o.val(),isNewWindow:r.is(":checked")}),n.modal("hide")})}).one("hidden.bs.modal",function(){o.off("input keypress"),i.off("input keypress"),e.off("click"),"pending"===t.state()&&t.reject()}).modal("show")}).promise()},this.show=function(e){var t=e.editor(),n=e.dialog(),o=e.editable(),i=e.popover(),e=a.invoke("editor.getLinkInfo",o),r=t.data("options");a.invoke("editor.saveRange",o),this.showLinkDialog(o,n,e).then(function(e){a.invoke("editor.restoreRange",o),a.invoke("editor.createLink",o,e,r),a.invoke("popover.hide",i)}).fail(function(){a.invoke("editor.restoreRange",o)})}}function Se(o){this.show=function(t){var e=t.dialog(),n=t.editable();o.invoke("editor.saveRange",n),this.showImageDialog(n,e).then(function(e){o.invoke("editor.restoreRange",n),"string"==typeof e?o.invoke("editor.insertImage",n,e):o.insertImages(t,e)}).fail(function(){o.invoke("editor.restoreRange",n)})},this.showImageDialog=function(e,t){return w.Deferred(function(n){var o=t.find(".note-image-dialog"),e=t.find(".note-image-input"),i=t.find(".note-image-url"),r=t.find(".note-image-btn");o.one("shown.bs.modal",function(){var t;e.replaceWith(e.clone().on("change",function(){n.resolve(this.files||this.value),o.modal("hide")}).val("")),r.click(function(e){e.preventDefault(),n.resolve(i.val()),o.modal("hide")}),i.on("keyup paste",function(e){var t="paste"===e.type?e.originalEvent.clipboardData.getData("text"):i.val();e=t,(t=r).toggleClass("disabled",!e),t.attr("disabled",!e)}).val("").trigger("focus"),t=r,i.on("keypress",function(e){e.keyCode===Ce.code.ENTER&&t.trigger("click")})}).one("hidden.bs.modal",function(){e.off("change"),i.off("keyup paste keypress"),r.off("click"),"pending"===n.state()&&n.reject()}).modal("show")})}}function Pe(o){this.showHelpDialog=function(e,t){return w.Deferred(function(e){t.find(".note-help-dialog").one("hidden.bs.modal",function(){e.resolve()}).modal("show")}).promise()},this.show=function(e){var t=e.dialog(),n=e.editable();o.invoke("editor.saveRange",n,!0),this.showHelpDialog(n,t).then(function(){o.invoke("editor.restoreRange",n)})}}w.summernote=w.summernote||{},w.extend(w.summernote,{version:"0.6.16",options:{width:null,height:null,minHeight:null,maxHeight:null,focus:!1,tabsize:4,styleWithSpan:!0,disableLinkTarget:!1,disableDragAndDrop:!1,disableResizeEditor:!1,disableResizeImage:!1,shortcuts:!0,textareaAutoSync:!0,placeholder:!1,prettifyHtml:!0,iconPrefix:"fa fa-",icons:{font:{bold:"bold",italic:"italic",underline:"underline",clear:"eraser",height:"text-height",strikethrough:"strikethrough",superscript:"superscript",subscript:"subscript"},image:{image:"image",floatLeft:"align-left",floatRight:"align-right",floatNone:"align-justify",shapeRounded:"square",shapeCircle:"circle-o",shapeThumbnail:"image",shapeNone:"times",remove:"trash-o"},link:{link:"link",unlink:"unlink",edit:"edit"},table:{table:"table"},hr:{insert:"minus"},style:{style:"magic"},lists:{unordered:"list-ul",ordered:"list-ol"},options:{help:"question",fullscreen:"arrows-alt",codeview:"code"},paragraph:{paragraph:"align-left",outdent:"outdent",indent:"indent",left:"align-left",center:"align-center",right:"align-right",justify:"align-justify"},color:{recent:"font"},history:{undo:"undo",redo:"repeat"},misc:{check:"check"}},dialogsInBody:!1,codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","clear"]],["fontname",["fontname"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],plugin:{},airMode:!1,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Helvetica Neue",fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontNamesIgnoreCheck:[],fontSizes:["8","9","10","11","12","14","18","24","36"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],insertTableMaxSize:{col:10,row:10},maximumImageFileSize:null,oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onMediaDelete:null,onToolbarClick:null,onsubmit:null,onCreateLink:function(e){return-1!==e.indexOf("@")&&-1===e.indexOf(":")&&(e="mailto:"+e),e},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},history:{undo:"Undo",redo:"Redo"}}}});var Le=new function(){function p(e,t){var n=t.event,o=t.value,i=t.title,r=t.className,a=t.dropdown,t=t.hide;return(a?'<div class="btn-group'+(r?" "+r:"")+'">':"")+'<button type="button" class="btn btn-default btn-sm'+(!a&&r?" "+r:"")+(a?" dropdown-toggle":"")+'"'+(a?' data-toggle="dropdown"':"")+(i?' title="'+i+'"':"")+(n?' data-event="'+n+'"':"")+(o?" data-value='"+o+"'":"")+(t?" data-hide='"+t+"'":"")+' tabindex="-1">'+e+(a?' <span class="caret"></span>':"")+"</button>"+(a||"")+(a?"</div>":"")}function m(e,t){return p('<i class="'+e+'"></i>',t)}function g(e,t){return(e=w('<div class="'+e+' popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content"></div></div>')).find(".popover-content").append(t),e}function i(e,t,n,o){return'<div class="'+e+' modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content">'+(t?'<div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4 class="modal-title">'+t+"</h4></div>":"")+'<div class="modal-body">'+n+"</div>"+(o?'<div class="modal-footer">'+o+"</div>":"")+"</div></div></div>"}function s(e,t,n){return t="dropdown-menu"+(t?" "+t:""),n=n||"ul",e instanceof Array&&(e=e.join("")),"<"+n+' class="'+t+'">'+e+"</"+n+">"}function v(l,d){var e,t,n,o,i,r,a,s,c,u,f,h=w('<div class="note-popover" />');return h.append((u=m(d.iconPrefix+d.icons.link.edit,{title:l.link.edit,event:"showLinkDialog",hide:!0}),f=m(d.iconPrefix+d.icons.link.unlink,{title:l.link.unlink,event:"unlink"}),g("note-link-popover",'<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group">'+u+f+"</div>"))),h.append((e=p('<span class="note-fontsize-10">100%</span>',{title:l.image.resizeFull,event:"resize",value:"1"}),t=p('<span class="note-fontsize-10">50%</span>',{title:l.image.resizeHalf,event:"resize",value:"0.5"}),n=p('<span class="note-fontsize-10">25%</span>',{title:l.image.resizeQuarter,event:"resize",value:"0.25"}),o=m(d.iconPrefix+d.icons.image.floatLeft,{title:l.image.floatLeft,event:"floatMe",value:"left"}),i=m(d.iconPrefix+d.icons.image.floatRight,{title:l.image.floatRight,event:"floatMe",value:"right"}),r=m(d.iconPrefix+d.icons.image.floatNone,{title:l.image.floatNone,event:"floatMe",value:"none"}),a=m(d.iconPrefix+d.icons.image.shapeRounded,{title:l.image.shapeRounded,event:"imageShape",value:"img-rounded"}),s=m(d.iconPrefix+d.icons.image.shapeCircle,{title:l.image.shapeCircle,event:"imageShape",value:"img-circle"}),c=m(d.iconPrefix+d.icons.image.shapeThumbnail,{title:l.image.shapeThumbnail,event:"imageShape",value:"img-thumbnail"}),u=m(d.iconPrefix+d.icons.image.shapeNone,{title:l.image.shapeNone,event:"imageShape",value:""}),f=m(d.iconPrefix+d.icons.image.remove,{title:l.image.remove,event:"removeMedia",value:"none"}),f=(d.disableResizeImage?"":'<div class="btn-group">'+e+t+n+"</div>")+'<div class="btn-group">'+o+i+r+'</div><br><div class="btn-group">'+a+s+c+u+'</div><div class="btn-group">'+f+"</div>",g("note-image-popover",f))),d.airMode&&h.append(function(){for(var e=w("<div />"),t=0,n=d.airPopover.length;t<n;t++){for(var o=d.airPopover[t],i=w('<div class="note-'+o[0]+' btn-group">'),r=0,a=o[1].length;r<a;r++){var s=w(x[o[1][r]](l,d));s.attr("data-name",o[1][r]),i.append(s)}e.append(i)}return g("note-air-popover",e.children())}()),h}function b(e){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-holder note-control-nw"></div><div class="note-control-holder note-control-ne"></div><div class="note-control-holder note-control-sw"></div><div class="'+(e.disableResizeImage?"note-control-holder":"note-control-sizing")+' note-control-se"></div>'+(e.disableResizeImage?"":'<div class="note-control-selection-info"></div>')+"</div></div>"}function r(e,t){var n,o="note-shortcut-col col-xs-6 note-shortcut-",i=[];for(n in t)t.hasOwnProperty(n)&&i.push('<div class="'+o+'key">'+t[n].kbd+'</div><div class="'+o+'name">'+t[n].text+"</div>");return'<div class="note-shortcut-row row"><div class="'+o+'title col-xs-offset-6">'+e+'</div></div><div class="note-shortcut-row row">'+i.join('</div><div class="note-shortcut-row row">')+"</div>"}function n(e,t){var n,o='class="note-shortcut note-shortcut-col col-sm-6 col-xs-12"',i=["<div "+o+">"+(i=[{kbd:"⌘ + Z",text:(n=e).history.undo},{kbd:"⌘ + ⇧ + Z",text:n.history.redo},{kbd:"⌘ + ]",text:n.paragraph.indent},{kbd:"⌘ + [",text:n.paragraph.outdent},{kbd:"⌘ + ENTER",text:n.hr.insert}],r(n.shortcut.action,i))+"</div><div "+o+">"+(i=[{kbd:"⌘ + B",text:(n=e).font.bold},{kbd:"⌘ + I",text:n.font.italic},{kbd:"⌘ + U",text:n.font.underline},{kbd:"⌘ + \\",text:n.font.clear}],r(n.shortcut.textFormatting,i))+"</div>","<div "+o+">"+(i=[{kbd:"⌘ + NUM0",text:(n=e).style.normal},{kbd:"⌘ + NUM1",text:n.style.h1},{kbd:"⌘ + NUM2",text:n.style.h2},{kbd:"⌘ + NUM3",text:n.style.h3},{kbd:"⌘ + NUM4",text:n.style.h4},{kbd:"⌘ + NUM5",text:n.style.h5},{kbd:"⌘ + NUM6",text:n.style.h6}],r(n.shortcut.documentStyle,i))+"</div><div "+o+">"+(i=[{kbd:"⌘ + ⇧ + L",text:(n=e).paragraph.left},{kbd:"⌘ + ⇧ + E",text:n.paragraph.center},{kbd:"⌘ + ⇧ + R",text:n.paragraph.right},{kbd:"⌘ + ⇧ + J",text:n.paragraph.justify},{kbd:"⌘ + ⇧ + NUM7",text:n.lists.ordered},{kbd:"⌘ + ⇧ + NUM8",text:n.lists.unordered}],r(n.shortcut.paragraphFormatting,i))+"</div>"];return t.extraKeys&&i.push("<div "+o+">"+function(e,t){var n,o=t.extraKeys,i=[];for(n in o)o.hasOwnProperty(n)&&i.push({kbd:n,text:o[n]});return r(e.shortcut.extraKeys,i)}(e,t)+"</div>"),'<div class="note-shortcut-row row">'+i.join('</div><div class="note-shortcut-row row">')+"</div>"}function y(n,o){var i="";return w.each(a,function(e,t){i+=t(n,o)}),'<div class="note-dialog">'+i+"</div>"}function C(e,t,n){var o=h.invertObject(t);e.find("button").each(function(e,t){var t=w(t),n=o[t.data("event")];n&&t.attr("title",function(e,t){return t+" ("+(t=n,N.isMac&&(t=t.replace("CMD","⌘").replace("SHIFT","⇧")),t.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]"))+")"})}).b_tooltip({container:"body",trigger:"hover",placement:n||"top"}).on("click",function(){w(this).b_tooltip("hide")})}function k(e,t){var c=t.colors;e.find(".note-color-palette").each(function(){for(var e=w(this),t=e.attr("data-target-event"),n=[],o=0,i=c.length;o<i;o++){for(var r=c[o],a=[],s=0,l=r.length;s<l;s++){var d=r[s];a.push(['<button type="button" class="note-color-btn" style="background-color:',d,';" data-event="',t,'" data-value="',d,'" title="',d,'" data-toggle="button" tabindex="-1"></button>'].join(""))}n.push('<div class="note-color-row">'+a.join("")+"</div>")}e.html(n.join(""))})}var x={picture:function(e,t){return m(t.iconPrefix+t.icons.image.image,{event:"showImageDialog",title:e.image.image,hide:!0})},link:function(e,t){return m(t.iconPrefix+t.icons.link.link,{event:"showLinkDialog",title:e.link.link,hide:!0})},table:function(e,t){return m(t.iconPrefix+t.icons.table.table,{title:e.table.table,dropdown:s(['<div class="note-dimension-picker">','<div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div>','<div class="note-dimension-picker-highlighted"></div>','<div class="note-dimension-picker-unhighlighted"></div>',"</div>",'<div class="note-dimension-display"> 1 x 1 </div>'],"note-table")})},style:function(o,e){var t=e.styleTags.reduce(function(e,t){var n=o.style["p"===t?"normal":t];return e+'<li><a data-event="formatBlock" href="#" data-value="'+t+'">'+("p"===t||"pre"===t?n:"<"+t+">"+n+"</"+t+">")+"</a></li>"},"");return m(e.iconPrefix+e.icons.style.style,{title:o.style.style,dropdown:s(t)})},fontname:function(e,n){var o=[],t=n.fontNames.reduce(function(e,t){return N.isFontInstalled(t)||T.contains(n.fontNamesIgnoreCheck,t)?(o.push(t),e+'<li><a data-event="fontName" href="#" data-value="'+t+'" style="font-family:\''+t+'\'"><i class="'+n.iconPrefix+n.icons.misc.check+'"></i> '+t+"</a></li>"):e},""),i=N.isFontInstalled(n.defaultFontName)?n.defaultFontName:o[0];return p('<span class="note-current-fontname">'+i+"</span>",{title:e.font.name,className:"note-fontname",dropdown:s(t,"note-check")})},fontsize:function(e,n){var t=n.fontSizes.reduce(function(e,t){return e+'<li><a data-event="fontSize" href="#" data-value="'+t+'"><i class="'+n.iconPrefix+n.icons.misc.check+'"></i> '+t+"</a></li>"},"");return p('<span class="note-current-fontsize">11</span>',{title:e.font.size,className:"note-fontsize",dropdown:s(t,"note-check")})},color:function(e,t){var n='<i class="'+t.iconPrefix+t.icons.color.recent+'" style="color:black;background-color:yellow;"></i>',t=p(n,{className:"note-recent-color",title:e.color.recent,event:"color",value:'{"backColor":"yellow"}'}),n=['<li><div class="btn-group">','<div class="note-palette-title">'+e.color.background+"</div>",'<div class="note-color-reset" data-event="backColor"',' data-value="inherit" title="'+e.color.transparent+'">'+e.color.setTransparent+"</div>",'<div class="note-color-palette" data-target-event="backColor"></div>','</div><div class="btn-group">','<div class="note-palette-title">'+e.color.foreground+"</div>",'<div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+e.color.reset+'">',e.color.resetToDefault,"</div>",'<div class="note-color-palette" data-target-event="foreColor"></div>',"</div></li>"];return t+p("",{title:e.color.more,dropdown:s(n)})},bold:function(e,t){return m(t.iconPrefix+t.icons.font.bold,{event:"bold",title:e.font.bold})},italic:function(e,t){return m(t.iconPrefix+t.icons.font.italic,{event:"italic",title:e.font.italic})},underline:function(e,t){return m(t.iconPrefix+t.icons.font.underline,{event:"underline",title:e.font.underline})},strikethrough:function(e,t){return m(t.iconPrefix+t.icons.font.strikethrough,{event:"strikethrough",title:e.font.strikethrough})},superscript:function(e,t){return m(t.iconPrefix+t.icons.font.superscript,{event:"superscript",title:e.font.superscript})},subscript:function(e,t){return m(t.iconPrefix+t.icons.font.subscript,{event:"subscript",title:e.font.subscript})},clear:function(e,t){return m(t.iconPrefix+t.icons.font.clear,{event:"removeFormat",title:e.font.clear})},ul:function(e,t){return m(t.iconPrefix+t.icons.lists.unordered,{event:"insertUnorderedList",title:e.lists.unordered})},ol:function(e,t){return m(t.iconPrefix+t.icons.lists.ordered,{event:"insertOrderedList",title:e.lists.ordered})},paragraph:function(e,t){var n=m(t.iconPrefix+t.icons.paragraph.left,{title:e.paragraph.left,event:"justifyLeft"}),o=m(t.iconPrefix+t.icons.paragraph.center,{title:e.paragraph.center,event:"justifyCenter"}),i=m(t.iconPrefix+t.icons.paragraph.right,{title:e.paragraph.right,event:"justifyRight"}),r=m(t.iconPrefix+t.icons.paragraph.justify,{title:e.paragraph.justify,event:"justifyFull"}),a=m(t.iconPrefix+t.icons.paragraph.outdent,{title:e.paragraph.outdent,event:"outdent"}),a=['<div class="note-align btn-group">',n+o+i+r,'</div><div class="note-list btn-group">',m(t.iconPrefix+t.icons.paragraph.indent,{title:e.paragraph.indent,event:"indent"})+a,"</div>"];return m(t.iconPrefix+t.icons.paragraph.paragraph,{title:e.paragraph.paragraph,dropdown:s(a,"","div")})},height:function(e,n){var t=n.lineHeights.reduce(function(e,t){return e+'<li><a data-event="lineHeight" href="#" data-value="'+parseFloat(t)+'"><i class="'+n.iconPrefix+n.icons.misc.check+'"></i> '+t+"</a></li>"},"");return m(n.iconPrefix+n.icons.font.height,{title:e.font.height,dropdown:s(t,"note-check")})},help:function(e,t){return m(t.iconPrefix+t.icons.options.help,{event:"showHelpDialog",title:e.options.help,hide:!0})},fullscreen:function(e,t){return m(t.iconPrefix+t.icons.options.fullscreen,{event:"fullscreen",title:e.options.fullscreen})},codeview:function(e,t){return m(t.iconPrefix+t.icons.options.codeview,{event:"codeview",title:e.options.codeview})},undo:function(e,t){return m(t.iconPrefix+t.icons.history.undo,{event:"undo",title:e.history.undo})},redo:function(e,t){return m(t.iconPrefix+t.icons.history.redo,{event:"redo",title:e.history.redo})},hr:function(e,t){return m(t.iconPrefix+t.icons.hr.insert,{event:"insertHorizontalRule",title:e.hr.insert})}},a={image:function(e,t){var n="";t.maximumImageFileSize&&(o=Math.floor(Math.log(t.maximumImageFileSize)/Math.log(1024)),o=+(t.maximumImageFileSize/Math.pow(1024,o)).toFixed(2)+" "+" KMGTP"[o]+"B",n="<small>"+e.image.maximumFileSize+" : "+o+"</small>");var o='<div class="form-group row note-group-select-from-files" style="display: none;"><label>'+e.image.selectFromFiles+'</label><input class="note-image-input form-control" type="file" name="files" accept="image/*" multiple="multiple" />'+n+'</div><div class="form-group row"><label>'+e.image.url+'</label><br/><input class="note-image-url form-control col-md-12" type="text" style="width: 400px !important;margin-right: 18px;" /><a class="btn btn-default imageBtn" style=" display: inline-block; margin: 0px;">'+e.image.selectFromFiles+"</a></div>",n='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+e.image.insert+"</button>";return i("note-image-dialog",e.image.insert,o,n)},link:function(e,t){var n='<div class="form-group row"><label>'+e.link.textToDisplay+'</label><input class="note-link-text form-control col-md-12" type="text" /></div><div class="form-group row"><label>'+e.link.url+'</label><input class="note-link-url form-control col-md-12" type="text" value="http://" /></div>'+(t.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+e.link.openInNewWindow+"</label></div>"),t='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+e.link.insert+"</button>";return i("note-link-dialog",e.link.insert,n,t)},help:function(e,t){t='<a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+e.shortcut.close+'</a><div class="title">'+e.shortcut.shortcuts+"</div>"+(N.isMac?n(e,t):n(e,t).replace(/⌘/g,"Ctrl").replace(/⇧/g,"Shift"))+'<p class="text-center"><a href="//summernote.org/" target="_blank">Summernote 0.6.16</a> · <a href="//github.com/summernote/summernote" target="_blank">Project</a> · <a href="//github.com/summernote/summernote/issues" target="_blank">Issues</a></p>';return i("note-help-dialog","",t,"")}};this.createLayoutByAirMode=function(e,t){var n=t.langInfo,o=t.keyMap[N.isMac?"mac":"pc"],i=h.uniqueId();e.addClass("note-air-editor note-editable panel-body"),e.attr({id:"note-editor-"+i,contentEditable:!0});var r=document.body,e=w(v(n,t));e.addClass("note-air-layout"),e.attr("id","note-popover-"+i),e.appendTo(r),C(e,o),k(e,t);e=w(b(t));e.addClass("note-air-layout"),e.attr("id","note-handle-"+i),e.appendTo(r);t=w(y(n,t));t.addClass("note-air-layout"),t.attr("id","note-dialog-"+i),t.find("button.close, a.modal-close").click(function(){w(this).closest(".modal").modal("hide")}),t.appendTo(r)},this.createLayoutByFrame=function(e,t){var n=t.langInfo,o=w('<div class="note-editor panel panel-default" />');t.width&&o.width(t.width),0<t.height&&w('<div class="note-statusbar">'+(t.disableResizeEditor?"":'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>')+"</div>").prependTo(o);var i=w('<div class="note-editing-area" />'),r=!e.is(":disabled"),a=w('<div class="note-editable panel-body" contentEditable="'+r+'"></div>').prependTo(i);t.height&&a.height(t.height),t.direction&&a.attr("dir",t.direction);r=e.attr("placeholder")||t.placeholder;r&&a.attr("data-placeholder",r),a.html(S.html(e)||S.emptyPara),w('<textarea class="note-codable"></textarea>').prependTo(i);a=w(v(n,t)).prependTo(i);k(a,t),C(a,void 0),w(b(t)).prependTo(i),i.prependTo(o);for(var s=w('<div class="note-toolbar panel-heading" />'),l=0,d=t.toolbar.length;l<d;l++){for(var c=t.toolbar[l][0],u=t.toolbar[l][1],f=w('<div class="note-'+c+' btn-group" />'),h=0,p=u.length;h<p;h++){var m=x[u[h]];w.isFunction(m)&&((m=w(m(n,t))).attr("data-name",u[h]),f.append(m))}s.append(f)}i=t.keyMap[N.isMac?"mac":"pc"];k(s,t),C(s,i,"bottom"),s.prependTo(o),w('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(o);i=t.dialogsInBody?w(document.body):o;w(y(n,t)).prependTo(i).find("button.close, a.modal-close").click(function(){w(this).closest(".modal").modal("hide")}),o.insertAfter(e),e.hide()},this.hasNoteEditor=function(e){return 0<this.noteEditorFromHolder(e).length},this.noteEditorFromHolder=function(e){return e.hasClass("note-air-editor")?e:e.next().hasClass("note-editor")?e.next():w()},this.createLayout=function(e,t){t.airMode?this.createLayoutByAirMode(e,t):this.createLayoutByFrame(e,t)},this.layoutInfoFromHolder=function(e){var t=this.noteEditorFromHolder(e);if(t.length)return t.data("holder",e),S.buildLayoutInfo(t)},this.removeLayout=function(e,t,n){n.airMode?(e.removeClass("note-air-editor note-editable").removeAttr("id contentEditable"),t.popover().remove(),t.handle().remove(),t.dialog().remove()):(e.html(t.editable().html()),n.dialogsInBody&&t.dialog().remove(),t.editor().remove(),e.show())},this.getTemplate=function(){return{button:p,iconButton:m,dialog:i}},this.addButtonInfo=function(e,t){x[e]=t},this.addDialogInfo=function(e,t){a[e]=t}},Ee=new function(){var o=this,s=this.modules={editor:new ce(this),toolbar:new fe,statusbar:new he,popover:new pe,handle:new me(this),fullscreen:new ge(this),codeview:new xe(this),dragAndDrop:new we(this),clipboard:new Ne(this),linkDialog:new Te(this),imageDialog:new Se(this),helpDialog:new Pe(this)};this.invoke=function(){var e=T.head(T.from(arguments)),t=T.tail(T.from(arguments)),n=e.split("."),o=1<n.length,e=o&&T.head(n),n=o?T.last(n):T.head(n),e=this.getModule(e),n=e[n];return n&&n.apply(e,t)},this.getModule=function(e){return this.modules[e]||this.modules.editor};var l=this.bindCustomEvent=function(t,n,o){return function(){var e=n[h.namespaceToCamel(o,"on")];return e&&e.apply(t[0],arguments),t.trigger("summernote."+o,arguments)}};this.insertImages=function(e,t){var n=e.editor(),o=e.editable(),i=e.holder(),r=o.data("callbacks"),a=n.data("options");r.onImageUpload?l(i,r,"image.upload")(t):w.each(t,function(e,t){var n=t.name;a.maximumImageFileSize&&a.maximumImageFileSize<t.size?l(i,r,"image.upload.error")(a.langInfo.image.maximumFileSizeError):ye.readFileAsDataURL(t).then(function(e){s.editor.insertImage(o,e,n)}).fail(function(){l(i,r,"image.upload.error")(a.langInfo.image.maximumFileSizeError)})})};function i(e){S.isImg(e.target)&&e.preventDefault()}function r(e){var t=S.makeLayoutInfo(e.currentTarget||e.target);s.editor.removeBogus(t.editable()),f(e)}var d={showLinkDialog:function(e){s.linkDialog.show(e)},showImageDialog:function(e){s.imageDialog.show(e)},showHelpDialog:function(e){s.helpDialog.show(e)},fullscreen:function(e){s.fullscreen.toggle(e)},codeview:function(e){s.codeview.toggle(e)}};this.updateStyleInfo=function(e,t){var n;e&&((n=t.editor().data("options").airMode)||s.toolbar.update(t.toolbar(),e),s.popover.update(t.popover(),e,n),s.handle.update(t.handle(),e,n))};function a(e){e=S.makeLayoutInfo(e.currentTarget||e.target),s.popover.hide(e.popover()),s.handle.hide(e.handle())}function c(e){w(e.target).closest("[data-event]").length&&e.preventDefault()}function u(e){var t,n,o,i,r,a=w(e.target).closest("[data-event]");a.length&&(t=a.attr("data-event"),n=a.attr("data-value"),r=a.attr("data-hide"),o=S.makeLayoutInfo(e.target),-1!==w.inArray(t,["resize","floatMe","removeMedia","imageShape"])&&(i=o.handle().find(".note-control-selection"),i=w(i.data("target"))),r&&a.parents(".popover").hide(),w.isFunction(w.summernote.pluginEvents[t])?w.summernote.pluginEvents[t](e,s.editor,o,n):s.editor[t]?((r=o.editable()).focus(),s.editor[t](r,n,i),e.preventDefault()):d[t]&&(d[t].call(this,o),e.preventDefault()),-1!==w.inArray(t,["backColor","foreColor"])&&(o.editor().data("options",void 0).airMode?s.popover:s.toolbar).updateRecentColor(T.head(a),t,n),f(e))}var f=function(e){var n=e.target;setTimeout(function(){var e=S.makeLayoutInfo(n),t=s.editor.currentStyle(n);o.updateStyleInfo(t,e)},0)};this.bindKeyMap=function(o,i){var r=o.editor(),a=o.editable();a.on("keydown",function(e){var t=[];e.metaKey&&t.push("CMD"),e.ctrlKey&&!e.altKey&&t.push("CTRL"),e.shiftKey&&t.push("SHIFT");var n=Ce.nameFromCode[e.keyCode];n&&t.push(n);var n=t.join("+"),t=i[n];if(t){if(n=w.summernote.pluginEvents[n],w.isFunction(n)&&n(e,s.editor,o))return!1;n=w.summernote.pluginEvents[t],w.isFunction(n)?n(e,s.editor,o):s.editor[t]?(s.editor[t](a,r.data("options")),e.preventDefault()):d[t]&&(d[t].call(this,o),e.preventDefault())}else Ce.isEdit(e.keyCode)&&s.editor.afterCommand(a)})},this.attach=function(e,t){t.shortcuts&&this.bindKeyMap(e,t.keyMap[N.isMac?"mac":"pc"]),e.editable().on("mousedown",i),e.editable().on("keyup mouseup",r),e.editable().on("scroll",a),s.clipboard.attach(e,t),s.handle.attach(e,t),e.popover().on("click",u),e.popover().on("mousedown",c),s.dragAndDrop.attach(e,t),t.airMode||(e.toolbar().on("click",u),e.toolbar().on("mousedown",c),s.statusbar.attach(e,t)),(t.airMode?e.popover():e.toolbar()).find(".note-dimension-picker-mousecatcher").css({width:t.insertTableMaxSize.col+"em",height:t.insertTableMaxSize.row+"em"}).on("mousemove",function(e){!function(e,t){var n=(r=w(e.target.parentNode)).next(),o=r.find(".note-dimension-picker-mousecatcher"),i=r.find(".note-dimension-picker-highlighted"),r=r.find(".note-dimension-picker-unhighlighted");a=void 0===e.offsetX?(a=w(e.target).offset(),{x:e.pageX-a.left,y:e.pageY-a.top}):{x:e.offsetX,y:e.offsetY};var e=Math.ceil(a.x/18)||1,a=Math.ceil(a.y/18)||1;i.css({width:e+"em",height:a+"em"}),o.attr("data-value",e+"x"+a),3<e&&e<t.insertTableMaxSize.col&&r.css({width:e+1+"em"}),3<a&&a<t.insertTableMaxSize.row&&r.css({height:a+1+"em"}),n.html(e+" x "+a)}(e,t)}),e.editor().data("options",t),N.isMSIE||setTimeout(function(){document.execCommand("styleWithCSS",0,t.styleWithSpan)},0);var n=new re(e.editable());e.editable().data("NoteHistory",n),e.editable().data("callbacks",{onInit:t.onInit,onFocus:t.onFocus,onBlur:t.onBlur,onKeydown:t.onKeydown,onKeyup:t.onKeyup,onMousedown:t.onMousedown,onEnter:t.onEnter,onPaste:t.onPaste,onBeforeCommand:t.onBeforeCommand,onChange:t.onChange,onImageUpload:t.onImageUpload,onImageUploadError:t.onImageUploadError,onMediaDelete:t.onMediaDelete,onToolbarClick:t.onToolbarClick});n=s.editor.styleFromNode(e.editable());this.updateStyleInfo(n,e)},this.attachCustomEvent=function(t,e){var n=t.holder(),o=t.editable(),i=o.data("callbacks");o.focus(l(n,i,"focus")),o.blur(l(n,i,"blur")),o.keydown(function(e){e.keyCode===Ce.code.ENTER&&l(n,i,"enter").call(this,e),l(n,i,"keydown").call(this,e)}),o.keyup(l(n,i,"keyup")),o.on("mousedown",l(n,i,"mousedown")),o.on("mouseup",l(n,i,"mouseup")),o.on("scroll",l(n,i,"scroll")),o.on("paste",l(n,i,"paste"));var r=N.isMSIE?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input";o.on(r,function(){l(n,i,"change")(o.html(),o)}),e.airMode||(t.toolbar().click(l(n,i,"toolbar.click")),t.popover().click(l(n,i,"popover.click"))),S.isTextarea(T.head(n))&&n.closest("form").submit(function(e){t.holder().val(t.holder().code()),l(n,i,"submit").call(this,e,n.code())}),S.isTextarea(T.head(n))&&e.textareaAutoSync&&n.on("summernote.change",function(){t.holder().val(t.holder().code())}),l(n,i,"init")(t);for(var a=0,s=w.summernote.plugins.length;a<s;a++)w.isFunction(w.summernote.plugins[a].init)&&w.summernote.plugins[a].init(t)},this.detach=function(e,t){e.holder().off(),e.editable().off(),e.popover().off(),e.handle().off(),e.dialog().off(),t.airMode||(e.dropzone().off(),e.toolbar().off(),e.statusbar().off())}};w.extend(w.summernote,{renderer:Le,eventHandler:Ee,core:{agent:N,list:T,dom:S,range:ne},pluginEvents:{},plugins:[]}),w.summernote.addPlugin=function(e){w.summernote.plugins.push(e),e.buttons&&w.each(e.buttons,function(e,t){Le.addButtonInfo(e,t)}),e.dialogs&&w.each(e.dialogs,function(e,t){Le.addDialogInfo(e,t)}),e.events&&w.each(e.events,function(e,t){w.summernote.pluginEvents[e]=t}),e.langs&&w.each(e.langs,function(e,t){w.summernote.lang[e]&&w.extend(w.summernote.lang[e],t)}),e.options&&w.extend(w.summernote.options,e.options)},w.fn.extend({summernote:function(){var e=w.type(T.head(arguments)),t="string"===e,n="object"===e,o=n?T.head(arguments):{};if((o=w.extend({},w.summernote.options,o)).icons=w.extend({},w.summernote.options.icons,o.icons),o.langInfo=w.extend(!0,{},w.summernote.lang["en-US"],w.summernote.lang[o.lang]),!t&&n)for(var i=0,r=w.summernote.plugins.length;i<r;i++){var a=w.summernote.plugins[i];o.plugin[a.name]&&(w.summernote.plugins[i]=w.extend(!0,a,o.plugin[a.name]))}this.each(function(e,t){var n=w(t);Le.hasNoteEditor(n)||(Le.createLayout(n,o),t=Le.layoutInfoFromHolder(n),n.data("layoutInfo",t),Ee.attach(t,o),Ee.attachCustomEvent(t,o))});e=this.first();if(e.length){n=Le.layoutInfoFromHolder(e);if(t){e=T.head(T.from(arguments)),t=T.tail(T.from(arguments)),t=[e,n.editable()].concat(t);return Ee.invoke.apply(Ee,t)}o.focus&&n.editable().focus()}return this},code:function(n){if(void 0!==n)return this.each(function(e,t){t=Le.layoutInfoFromHolder(w(t)),t=t&&t.editable();t&&t.html(n)}),this;var e=this.first();if(e.length){var t=Le.layoutInfoFromHolder(e),o=t&&t.editable();if(o&&o.length){o=Ee.invoke("codeview.isActivated",t);return Ee.invoke("codeview.sync",t),o?t.codable().val():t.editable().html()}return S.value(e)}},destroy:function(){return this.each(function(e,t){var n,o=w(t);Le.hasNoteEditor(o)&&(t=(n=Le.layoutInfoFromHolder(o)).editor().data("options"),Ee.detach(n,t),Le.removeLayout(o,n,t))}),this}})});