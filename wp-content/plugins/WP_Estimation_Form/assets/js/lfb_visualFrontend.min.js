!function(i){"use strict";var l=!1,e=!1,t=0,o=0,n=!1,a=null;function s(t,e,a){o=e,i(window).resize(function(){i("#lfb_bootstraped").css({height:i(window).height()})}),i("#lfb_bootstraped").css({height:i(window).height()});var l=e;0==l&&(l="final"),i("#lfb_bootstraped").addClass("lfb_visualEditing"),i("#lfb_form").addClass("lfb_visualEditing"),i("#lfb_form").attr("data-animspeed","0"),i("#lfb_form .lfb_genSlide.lfb_activeStep").removeClass("lfb_activeStep"),i("#lfb_form .lfb_genSlide").hide(),i('#lfb_form .lfb_genSlide[data-stepid="'+l+'"]').show(),i('#lfb_form .lfb_genSlide[data-stepid="'+l+'"]').addClass("lfb_activeStep"),setTimeout(function(){i('#lfb_form .lfb_genSlide:not([data-stepid="'+l+'"])').removeClass("lfb_activeStep"),i('#lfb_form .lfb_genSlide[data-stepid="'+l+'"]').addClass("lfb_activeStep")},1e3),i('#lfb_form .lfb_genSlide[data-stepid="'+l+'"] .errorMsg').hide(),i('#lfb_form .lfb_genSlide[data-stepid="'+l+'"] .lfb_btn-next').show(),i('#lfb_form .lfb_genSlide[data-stepid="'+l+'"]').is('[data-start="1"]')||i('#lfb_form .lfb_genSlide[data-stepid="'+l+'"] .lfb_linkPreviousCt').show(),i('#lfb_form .lfb_genSlide[data-stepid="'+l+'"] .lfb_stepTitle').addClass("positioned"),i('#lfb_form .lfb_genSlide[data-stepid="'+l+'"] .lfb_genContent').css({opacity:1}),i("#lfb_form.lfb_bootstraped #lfb_mainPanel").show(),i("#lfb_form.lfb_bootstraped #lfb_panel > .container-fluid > .row").hide(),setTimeout(function(){var t=i('#lfb_form.lfb_bootstraped #lfb_mainPanel .lfb_genSlide[data-stepid="'+l+'"] .lfb_stepTitle').height(),t=i(' #lfb_form.lfb_bootstraped #lfb_mainPanel .lfb_genSlide[data-stepid="'+l+'"] .lfb_genContent').outerHeight()+parseInt(i(" #lfb_form.lfb_bootstraped #lfb_mainPanel").css("padding-bottom"))+102+t;"final"==l&&(t-=80),i(' #lfb_form.lfb_bootstraped[data-form="'+a+'"] #lfb_mainPanel').animate({minHeight:t}),i(' #lfb_form.lfb_bootstraped[data-form="'+a+'"] #lfb_mainPanel').css("max-height","none")},300),i("#lfb_form .lfb_item:not(.lfb_componentInitialized)").each(function(){i(this).addClass("lfb_componentInitialized"),_(i(this)),p(i(this))}),jQuery(window).trigger("resize")}function d(a){jQuery.ajax({url:lfb_data.ajaxurl,type:"post",data:{action:"lfb_getItemDom",formID:t,itemID:a,stepID:o},success:function(t){var e=i(t);0<a?((t=i('#lfb_form .lfb_item[data-id="'+a+'"]')).after(e),t.remove()):i('#lfb_form .lfb_genSlide[data-stepid="'+o+'"] > .lfb_genContent > .lfb_row').html(e),0<a?(_(e),p(e),m(e),e.find(".lfb_item").each(function(){_(i(this)),p(i(this)),m(i(this))})):i('#lfb_form .lfb_genSlide[data-stepid="'+o+'"] > .lfb_genContent > .lfb_row').find(".lfb_item").each(function(){_(i(this)),p(i(this)),m(i(this))})}})}function f(e){var t=i("#lfb_rowMenu").find("table"),a=i('<tr data-id="'+e.id+'"></tr>');a.append('<td><select name="size" class="form-control form-control-sm"></select></td>'),a.find('[name="size"]').append('<option value="auto">'+lfb_data.texts.Automatic+"</option>"),a.find('[name="size"]').append('<option value="small">'+lfb_data.texts.Small+"</option>"),a.find('[name="size"]').append('<option value="medium">'+lfb_data.texts.Medium+"</option>"),a.find('[name="size"]').append('<option value="large">'+lfb_data.texts.Large+"</option>"),a.find('[name="size"]').append('<option value="xl">'+lfb_data.texts.XL+"</option>"),a.find('[name="size"]').append('<option value="fullWidth">'+lfb_data.texts["Full width"]+"</option>"),a.append('<td class="text-right lfb_tdAction"></td>'),a.find(".lfb_tdAction").append('<a href="javascript:" data-action="deleteColumn" class="btn btn-danger btn-circle"><span class="fas fa-trash"></span></a>'),t.find("tbody").append(a),r(n),d(n.attr("data-id")),a.find('[name="size"]').val(e.size),a.find('[name="size"]').on("change",function(){var t=i(this).val();r(n),jQuery.ajax({url:lfb_data.ajaxurl,type:"post",data:{action:"lfb_editRowColumn",rowID:n.attr("data-id"),columnID:e.id,size:t},success:function(){d(n.attr("data-id"))}})}),a.find('[data-action="deleteColumn"]').on("click",function(){i(this).closest("tr[data-id]").attr("data-id");i(this).closest("tr[data-id]").remove(),jQuery.ajax({url:lfb_data.ajaxurl,type:"post",data:{action:"lfb_deleteRowColumn",rowID:n.attr("data-id"),columnID:e.id},success:function(){r(n),d(n.attr("data-id"))}})})}function r(t){var e=new Array;i("#lfb_rowMenu table tr[data-id]").each(function(){e.push({id:i(this).attr("data-id"),size:i(this).find('[name="size"]').val()})}),t.attr("data-columns",JSON.stringify(e))}function c(){var e=new Array,a=new Array,l=new Array;i("#lfb_form .lfb_activeStep .lfb_item").each(function(){e.push(i(this).attr("data-id")),a.push(i(this).index());var t="";0<i(this).closest(".lfb_column").length&&(t=i(this).closest(".lfb_column").attr("data-columnid")),l.push(t)}),jQuery.ajax({url:lfb_data.ajaxurl,type:"post",data:{action:"lfb_itemsSort",stepID:o,itemsIDs:e,indexes:a,columnsIDs:l}})}function b(){jQuery.ajax({url:lfb_data.ajaxurl,type:"post",data:{action:"lfb_getComponentMenu"},success:function(t){var e;i("#lfb_bootstraped").prepend(t),i("#lfb_componentsCloseBtn").on("click",function(){i("#lfb_componentsPanel").removeClass("lfb_open")}),i("#lfb_form").find(".lfb_genSlide .lfb_genContent > .lfb_row").sortable({connectWith:".lfb_sortable",revert:10,delay:200,scroll:!1,items:".lfb_item",receive:function(t,e){i("#lfb_rowMenu").removeClass("lfb_open"),0<e.sender.closest(".lfb_lPanelBodyContent").length?h(e.item,""):(e.item.removeClass("col-md-12"),e.item.addClass("col-md-2"),setTimeout(function(){c()},100)),a=null},start:function(t,e){i("#lfb_form").addClass("lfb_draggingComponent"),e.helper.css("background-color",i("#lfb_mainPanel").css("background-color"))},over:function(t,e){},stop:function(t,e){i("#lfb_form").removeClass("lfb_draggingComponent"),e.item.removeClass("col-md-12"),e.item.addClass("col-md-2"),setTimeout(function(){c()},100)},update:function(t,e){}}).disableSelection(),i("#lfb_componentsPanel .lfb_lPanelBodyContent").addClass("lfb_sortable").sortable({connectWith:".lfb_sortable",revert:10,delay:200,scroll:!1,appendTo:i("#lfb_bootstraped"),items:".lfb_item",forcePlaceholderSize:!1,helper:function(t,e){return a=e.clone().insertAfter(e),e.clone()},start:function(t,e){l=!0,e.helper.css("background-color",i("#lfb_mainPanel").css("background-color")),i(".lfb_tmpComponent").remove();i('<div class="lfb_tmpComponent"></div>')},over:function(t,e){},stop:function(t,e){if(a&&a.remove(),l=!1,i(".lfb_tmpComponent").remove(),0<e.item.closest("#lfb_componentsPanel").length)return!1},update:function(t,e){}}).disableSelection(),i("#lfb_componentsPanel").find('[data-toggle="switch"]').wrap('<div class="switch"  data-on-label="<i class=\'fui-check\'></i>" data-off-label="<i class=\'fui-cross\'></i>" />').parent().bootstrapSwitch(),i("#lfb_componentsPanel").find('[data-type="slider"]').slider({min:0,max:100,value:50,step:1,orientation:"horizontal",range:"min"}),i("#lfb_componentsPanel").find(".lfb_rate").rate({initial_value:3}).css({color:"#bdc3c7"}),i("#lfb_componentsPanel #lfb_componentsFilters input.form-control").on("keyup change",function(){var t=i(this).val().toLowerCase();i("#lfb_componentsPanel .lfb_componentModel").each(function(){-1<i(this).find(".lfb_componentTitle").text().toLowerCase().indexOf(t)||0==t.trim().length?i(this).show():i(this).hide()})}),(e=i('<div id="lfb_rowMenu" class="lfb_lPanel lfb_lPanelRight"></div>')).append('<div class="lfb_lPanelHeader"><span class="fas fa-pencil-alt"></span><span id="lfb_lPanelHeaderTitle">'+lfb_data.texts["Row settings"]+'</span><a href="javascript:" id="lfb_rowMenuCloseBtn" class="btn btn-default btn-circle btn-inverse"><span class="glyphicon glyphicon-remove"></span></a></div>'),e.append(' <div class="lfb_lPanelBody"></div>'),i("#lfb_bootstraped").append(e),e.find(".lfb_lPanelBody").append("<label>"+lfb_data.texts.Columns+"</label>"),e.find(".lfb_lPanelBody").append('<table class="table table-striped"></table>'),e.find(".table").append("<thead></thead>"),e.find(".table thead").append("<tr><th>"+lfb_data.texts.Size+'</th><th class="text-right"><a href="javascript:" data-action="addColumn" class="btn btn-primary btn-circle" title="'+lfb_data.texts["Add a column"]+'"><span class="fas fa-plus"></span></a></th></tr>'),e.find(".table").append("<tbody></tbody>"),e.find("#lfb_rowMenuCloseBtn").on("click",function(){e.removeClass("lfb_open")}),e.find('a[data-action="addColumn"]').on("click",function(){i(this).closest("table"),i(this).closest("tr[data-id]").attr("data-id");jQuery.ajax({url:lfb_data.ajaxurl,type:"post",data:{action:"lfb_createRowColumn",rowID:n.attr("data-id")},success:function(t){f({size:"medium",id:t})}})})}})}function m(t){t.find('[data-toggle="switch"][data-checkboxstyle="switch"]').each(function(){0==i(this).closest(".switch").length&&i(this).wrap('<div class="switch"  data-on-label="<i class=\'fui-check\'></i>" data-off-label="<i class=\'fui-cross\'></i>" />').parent().bootstrapSwitch()}),t.find(".lfb_colorpicker").each(function(){i(this);i(this).prev(".lfb_colorPreview").on("click",function(){lfb_lfb_tld_selectionMode||i(this).next(".lfb_colorpicker").trigger("click")}),i(this).prev(".lfb_colorPreview").css({backgroundColor:i("#lfb_form").data("lfb_form").colorA}),i(this).colpick({color:i("#lfb_form").data("lfb_form").colorA,layout:"hex",onSubmit:function(){i("body > .colpick").fadeOut()},onChange:function(t,e,a,l,n){i(l).val("#"+e),i(l).prev(".lfb_colorPreview").css({backgroundColor:"#"+e})}})}),t.is(".lfb_gmap")&&0==t.find(".gm-style").length&&t.css({backgroundImage:"url("+lfb_data.assets_url+"/img/mapBg.jpg)",height:t.attr("data-height")}),t.find('img[data-tint="true"]').each(function(){i(this).css("opacity",0),i(this).show();var t=i('<canvas class="img"></canvas>');t.css({width:i(this).get(0).width,height:i(this).get(0).height}),i(this).hide(),i(this).after(t);var e=t.get(0).getContext("2d"),a=new Image;a.onload=function(){e.fillStyle=i("#lfb_form").data("lfb_form").colorA,e.fillRect(0,0,t.get(0).width,t.get(0).height),e.fill(),e.globalCompositeOperation="destination-in",e.drawImage(a,0,0,t.get(0).width,t.get(0).height)},i(this).is("[data-lazy-src]")?a.src=i(this).attr("data-lazy-src"):a.src=i(this).attr("src")}),t.find('[data-type="slider"]:not(.ui-slider)').each(function(){var t=parseInt(i(this).attr("data-min"));isNaN(t)&&(t=0);var e=parseInt(i(this).attr("data-max"));0==e&&(e=30),i(this).slider({min:t,max:e,value:0,step:1,orientation:"horizontal",range:"min"})}),t.find(".lfb_rate").each(function(){var t,e,a;0==i(this).children().length&&(t=parseInt(i(this).closest(".lfb_itemBloc").attr("data-max")),e=parseInt(i(this).closest(".lfb_itemBloc").attr("data-value")),isNaN(e)&&(e=5),a="#bdc3c7",""!=i(this).closest(".lfb_itemBloc").attr("data-color")&&(a=i(this).closest(".lfb_itemBloc").attr("data-color")),-1==a.indexOf("#")&&(a="#"+a),i(this).closest(".lfb_itemBloc").attr("data-interval"),i(this).rate({initial_value:e,max_value:t,step_size:1}).css("color",a))}),setTimeout(function(){t.find("canvas.img").each(function(){jQuery(this).parent().children("img").css("opacity",0),jQuery(this).parent().children("img").show(),jQuery(this).css({width:jQuery(this).parent().children("img").get(0).width,height:jQuery(this).parent().children("img").get(0).height}),jQuery(this).parent().children("img").hide()})},200)}function p(t){t.find(".lfb_column").sortable({connectWith:".lfb_sortable",revert:10,delay:200,scroll:!1,items:".lfb_item",start:function(t,e){i("#lfb_form").addClass("lfb_draggingComponent"),e.helper.css("background-color",i("#lfb_mainPanel").css("background-color"))},over:function(t,e){},receive:function(t,e){a=null,i("#lfb_rowMenu").removeClass("lfb_open"),0<e.sender.closest(".lfb_lPanelBodyContent").length?h(e.item,i(this).attr("data-columnid")):(e.item.removeClass("col-md-2"),setTimeout(function(){c()},100))},stop:function(t,e){i(this).is(".lfb_column")?e.item.removeClass("col-md-2"):(e.item.removeClass("col-md-12"),e.item.addClass("col-md-2")),i("#lfb_form").removeClass("lfb_draggingComponent")},update:function(t,e){}}).disableSelection()}function _(a){var t=i('<div class="lfb_elementToolbar"></div>');t.append('<a href="javascript:" class="btn-primary lfb-handler"><span class="fas fa-arrows-alt" data-tooltip="true"  data-placement="bottom" title="'+lfb_data.texts.move+'"></span></a>'),t.append('<a href="javascript:" data-action="edit" class="btn-default"><span class="fas fa-pencil-alt" data-tooltip="true"  data-placement="bottom" title="'+lfb_data.texts.edit+'"></span></a>'),t.append('<a href="javascript:" data-action="duplicate" class="btn-default"><span class="fas fa-copy" data-tooltip="true"  data-placement="bottom" title="'+lfb_data.texts.duplicate+'"></span></a>'),t.append('<a href="javascript:" data-action="style" class="btn-default"><span class="fas fa-magic" data-tooltip="true"  data-placement="bottom" title="'+lfb_data.texts.style+'"></span></a>'),t.append('<a href="javascript:" data-action="delete" class="btn-danger"><span class="fas fa-trash" data-tooltip="true"  data-placement="bottom" title="'+lfb_data.texts.remove+'"></span></a>'),t.find('[data-action="edit"]').on("click",function(){n=i(this).closest(".lfb_item"),"row"==i(this).closest(".lfb_item").attr("data-itemtype")?function(t){i("#lfb_rowMenu").addClass("lfb_open"),i("#lfb_rowMenu table tbody").html("");for(var e=JSON.parse(t.attr("data-columns")),a=0;a<e.length;a++)f(e[a])}(a):window.parent.jQuery("#lfb_form").trigger("lfb_editItem",[i(this).closest(".lfb_item").attr("data-id")])}),t.find('[data-action="style"]').on("click",function(){var t='.lfb_item[data-id="'+a.attr("data-id")+'"]',e=o;0==e&&(e="final"),window.parent.jQuery("#lfb_form").trigger("lfb_openFormDesigner",[e,t])}),t.find('[data-action="duplicate"]').on("click",function(){window.parent.jQuery("#lfb_form").trigger("lfb_duplicateItem",[i(this).closest(".lfb_item").attr("data-id")])}),t.find('[data-action="delete"]').on("click",function(){window.parent.jQuery("#lfb_form").trigger("lfb_askDeleteItem",[i(this).closest(".lfb_item").attr("data-id")])}),a.prepend(t),a.on("mouseenter",function(){clearTimeout(e);var t=!1;i(this).find(".lfb_item").each(function(){i(this).is(":hover")&&(t=!0)}),(l&&0<i(this).find(".lfb-column-inner.lfb_hoverEdit").length||!l&&0<i(this).find(".lfb-column-inner:hover").length)&&(t=!0),t?(i(this).removeClass("lfb_hover"),i(this).removeClass("lfb_hoverEdit")):(i(".lfb_hoverEdit").removeClass("lfb_hoverEdit"),i(this).addClass("lfb_hover"),i(this).addClass("lfb_hoverEdit"));i(this);i(this).parent().closest(".lfb_item ").removeClass("lfb_hover")}).on("mouseleave",function(){var t=i(this);t.removeClass("lfb_hover"),t.children(".lfb_hover").removeClass("lfb_hover"),e=setTimeout(function(){t.removeClass("lfb_hoverEdit"),t.children(".lfb_hoverEdit").removeClass("lfb_hoverEdit")},500),0<i(this).closest(".lfb_item :hover").length&&i(this).closest(".lfb_item :hover").trigger("mouseenter")}),a.prepend('<div class="lfb_itemLoader"><div class="lfb_spinner" data-tldinit="true"><div class="double-bounce1" data-tldinit="true"></div><div class="double-bounce2" data-tldinit="true"></div></div></div>'),a.find(".lfb_itemLoader").show().fadeOut(500)}function u(t,e){0<i('.lfb_item[data-id="'+e+'"]').length&&(i('.lfb_item[data-id="'+e+'"]').remove(),n&&n.attr("data-id")==e&&i("#lfb_rowMenuCloseBtn").trigger("click"))}function h(a,t){var e=a.index();a.prepend('<div class="lfb_itemLoader"><div class="lfb_spinner" data-tldinit="true"><div class="double-bounce1" data-tldinit="true"></div><div class="double-bounce2" data-tldinit="true"></div></div></div>'),a.find(".lfb_itemLoader").show();i('<div class="lfb_elementContent"></div>');var l=a.attr("data-component"),n=lfb_data.texts.Item;0<i('#lfb_componentsPanel .lfb_componentModel[data-component="'+l+'"] .lfb_componentTitle').length&&(n=i('#lfb_componentsPanel .lfb_componentModel[data-component="'+l+'"] .lfb_componentTitle').html()),jQuery.ajax({url:lfb_data.ajaxurl,type:"post",data:{action:"lfb_createNewItem",formID:i("#lfb_form").attr("data-form"),stepID:o,title:n,type:l,columnID:t,index:e},success:function(t){var e=(t=JSON.parse(t)).itemData;window.parent.jQuery("#lfb_form").trigger("lfb_newItemAdded",[e]);t=i(t.itemDom);a.after(t),_(t),m(t),p(t),a.remove(),c()}})}function v(){i("#lfb_componentsFilters input").val("").trigger("keyup"),i("#lfb_componentsFilters input").focus(),i("#lfb_componentsPanel").addClass("lfb_open")}i(window).on("load",function(){i("#lfb_form").addClass("lfb_visualReady"),i("#lfb_form").on("lfb_initComponentsMenu",b),i("#lfb_form").on("lfb_initVisualStep",s),i("#lfb_form").on("lfb_onItemDeleted",u),i("#lfb_form").on("lfb_showComponentsMenu",v),i("#lfb_form").on("lfb_refreshItemDom",function(t,e){d(e)}),t=i("#lfb_form").attr("data-form"),void 0!==window.parent&&0<i(window.parent.document).find("#lfb_form").length&&(window.parent.jQuery("#lfb_form").trigger("lfb_stepFrameLoaded"),b()),0!=o&&(i('#lfb_form .lfb_genSlide[data-stepid="'+o+'"]').show(),i('#lfb_form .lfb_genSlide[data-stepid="'+o+'"]').addClass("lfb_activeStep"))})}(jQuery);